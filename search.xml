<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>分子动力学初始结构构建程序Packmol的使用</title>
      <link href="/posts/4da5164e/"/>
      <url>/posts/4da5164e/</url>
      
        <content type="html"><![CDATA[<h2 id="1-packmol输入文件的设置">1. Packmol输入文件的设置</h2><p>Packmol的使用需要提供两类文件</p><ul><li><strong>输入文件</strong>。文件名随意，用来定义各种类型分子如何分布、有多少个。</li><li>各种要加入的分子的<strong>结构文件</strong>。一般使用pdb格式，用什么程序产生都可以。</li></ul><h3 id="1-1-全局设定">1.1 全局设定</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tolerance [数值]：要求原子间距离不能小于多少，一般设为2.0。Packmol里所有长度的单位都是Å</span><br><span class="line"></span><br><span class="line">output [文件名]：输出文件的路径</span><br><span class="line"></span><br><span class="line">filetype [类型]：输出文件的格式。默认为pdb，也可以设比如xyz</span><br><span class="line"></span><br><span class="line">seed -1：写这个的话每次运行产生的结构都会不同</span><br><span class="line"></span><br><span class="line">add_box_sides：给输出的pdb中增加CRYST1字段定义盒子，盒子尺寸对应体系中原子最大、最小坐标。如果写诸如add_box_sides 1.2，则会给盒子各方向再增加1.2Å，避免做模拟时有某些边界的原子和镜像盒子里的原子间存在不合理接触</span><br></pre></td></tr></table></figure><h3 id="1-2-分子设定">1.2 分子设定</h3><p>每个下面这种字段设置一种分子如何出现在当前体系中。可以写无数个这种字段。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">structure [分子结构文件]</span><br><span class="line">number [分子数]</span><br><span class="line">[分子规则]</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>分子规则用来定义分子里的所有原子必须满足的条件，其常用关键词如下。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">inside cube [xmin ymin zmin d]：要求分子出现在长度为d的立方盒子内，盒子x,y,z最小值为xmin ymin zmin</span><br><span class="line"></span><br><span class="line">inside box [xmin ymin zmin xmax ymax zmax]：要求分子出现在矩形盒子内，盒子两个顶角坐标分别为xmin ymin zmin和xmax ymax zmax</span><br><span class="line"></span><br><span class="line">inside sphere [x y z r]：要求分子出现在中心为(x,y,z)半径为r的圆球中。另外，用inside ellipsoid关键词的话还可以要求出现在特定的椭球中</span><br><span class="line"></span><br><span class="line">inside cylinder [a1 b1 c1 a2 b2 c2 r l]：要求分子出现在圆柱内。圆柱的定义是从(a1,b1,c1)往(a2,b2,c2)方向伸展l长度，半径为r</span><br><span class="line"></span><br><span class="line">以上inside都可以改为outside，要求不能出现在指定范围内。上面的空间范围要求可以同时使用多个，条件会同时满足。还有一些设置：</span><br><span class="line"></span><br><span class="line">over plane [a b c d]：要求分子出现位置满足平面方程ax+by+cz-d&gt;=0。比如over plane 1 0 0 10.5就相当于要求出现在x&gt;=10.5Å的区域。over可以改成below来反转条件。</span><br><span class="line"></span><br><span class="line">constrain_rotation [x/y/z 平均值 最大偏差]：默认情况下分子可以绕x,y,z轴随意旋转任意角度。用这个选项可以设置分子绕x或y或z旋转的情况，可以同时设多个。如constrain_rotation x 20 5代表允许绕着y和z轴随意旋转，而绕着x轴旋转的范围必须在15~25度之间，平均值为20度。</span><br><span class="line"></span><br><span class="line">fixed [x y z a b c]：用来直接定义分子出现在哪里。此设置代表将分子结构文件里的坐标平移(x,y,z)，并绕x,y,z轴分布旋转a,b,c弧度。如果还同时写了center关键词，相当于把分子的中心摆到(x,y,z)位置再旋转</span><br></pre></td></tr></table></figure><h3 id="1-3-原子设定">1.3 原子设定</h3><p>Packmol里还可以要求某种分子的某些特定序号的原子出现的范围必须满足的要求，格式为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">structure [分子结构文件]</span><br><span class="line">[分子规则]</span><br><span class="line">atoms [第一批原子序号]</span><br><span class="line">[原子规则]</span><br><span class="line">end atoms</span><br><span class="line">atoms [第二批原子序号]</span><br><span class="line">[原子规则]</span><br><span class="line">end atoms</span><br><span class="line">...</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>原子规则的设置语法、关键词和分子规则完全一样。</p><h2 id="2-几个实例">2. 几个实例</h2><p>下面举几个Packmol使用例子。所有输入输出文件都可以在此<a href="http://sobereva.com/attach/473/file.rar">下载</a></p><h3 id="2-1-构建5-5-5-nm-sup-3-sup-甲醇盒子">2.1 构建5×5×5 nm<sup>3</sup>甲醇盒子</h3><p>首先在GaussView或其它可以对分子建模的程序里画一个甲醇，然后保存为methanol.pdb。对于这种刚性小分子，用Packmol之前结构不需要非得优化，毕竟GaussView直接画的甲醇的基本几何参数是合理的，而且不管对其做不做优化，等动力学跑起来之后就都一样了。</p><p>创建一个名为methanol_box.inp的文本文件，内容如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tolerance 2.0</span><br><span class="line">add_box_sides 1.2</span><br><span class="line">output methanol_box.pdb</span><br><span class="line">structure methanol.pdb</span><br><span class="line"> number 1000</span><br><span class="line"> inside cube 0. 0. 0. 50.</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>将methanol.pdb和methanol_box.inp都放到当前目录，运行<code>packmol &lt; methanol_box.inp</code>，经过几秒钟，当前目录下就出现了methanol_box.pdb。将之拖到<a href="http://www.ks.uiuc.edu/Research/vmd/">VMD</a>程序里观看，并且在VMD的命令行窗口里输入<code>pbc box</code>显示出盒子，看到的图像如下</p><p><img src="/images/methanol_box.bmp" alt="img"></p><p>可见构建得很成功。但是1000个甲醇肯定不是Packmol能填充进这个5×5×5 nm<sup>3</sup>盒子的上限，因为Packmol很容易就产生成功了，而且从图上看还有一些空隙。如果大家希望得到更致密的盒子，可以尝试一点点增加甲醇的number数，看看设到多少的时候Packmol半天也没法成功产生结构或者提示产生失败，Packmol最多能插入多少甲醇你心里就有数了。</p><h3 id="2-2-构建水-甲醇混合溶液的气液界面体系">2.2 构建水+甲醇混合溶液的气液界面体系</h3><p>此例我们想构建一个水+甲醇摩尔比1:1溶液的气液界面体系，界面平行于XY方向，盒子的X、Y长度都为4 nm，溶液层厚度是5 nm，溶液上下两侧都是真空区，每一侧真空区厚度都是3 nm。</p><p>首先，我们靠Packmol创建一个水+甲醇的4×4×5 nm<sup>3</sup>的溶液盒子。甲醇的pdb文件已经有了，我们再用GaussView画个水，保存为water.pdb。然后编辑一个文件mix.inp，内容如下（经测试，水和甲醇各插入1000个时盒子已经比较致密了，而且已经需要好多轮循环才能成功产生结构，所以笔者就不再尝试插入更多了）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tolerance 2.0</span><br><span class="line">add_box_sides 1.2</span><br><span class="line">output mix.pdb</span><br><span class="line">structure water.pdb</span><br><span class="line"> number 1000</span><br><span class="line"> inside box 0. 0. 0. 40. 40. 50.</span><br><span class="line">end structure</span><br><span class="line">structure methanol.pdb</span><br><span class="line"> number 1000</span><br><span class="line"> inside box 0. 0. 0. 40. 40. 50.</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>将得到的mix.pdb弄到VMD里显示：</p><p><img src="/images/Water-methanol.bmp" alt="img"></p><p>但是目前还没有真空区。由于溶液层厚度为5nm，每一侧真空区厚度为3 nm，因此盒子Z方向总长度应为5+3+3=11 nm。因此我们在VMD里输入<code>pbc set &#123;40 40 110&#125;</code>来设置盒子尺寸为4×4×11 nm<sup>3</sup>，这里单位是Å。</p><p>目前溶剂区域在盒子最底部，我们要将之挪到盒子中间去，也即把所有原子往Z的正方向挪3nm。这可以用VMD的几何变换命令轻易实现。在VMD里输入<code>[atomselect top all] moveby &#123;0 0 30&#125;</code>，然后将VMD改成正交视角便于观看（Display - Orthographic），看到下图。</p><p><img src="/images/Water-methanol-gas-liquid.bmp" alt="img"></p><p>然后在VMD里将当前体系保存成新的pdb文件即可。值得一提的是，动力学模拟开始后，肯定最后达到稳定状态时溶液层厚度不可能正好是我们最初期望的5 nm，但由于目前已经堆积得比较致密了，应该偏离不太大。如果发现偏离的程度超过自己能接受的程度，可以在建模时再适当增加点分子数、在packmol建模时让盒子在Z方向稍微大一点。</p><h3 id="2-3-氯仿-甲醇-富勒烯体系">2.3 氯仿+甲醇+富勒烯体系</h3><p>这是一个稍微复杂的例子，没有什么实际意义，主要是体现Packmol的灵活性。此例我们要构建一个半径1.5nm的溶剂球，甲醇和氯仿各一个半球区域，并且富勒烯正好出现在球中央。</p><p>此例的输入文件如下。chloroform.pdb和C60.pdb都是GaussView直接构建的，后者在GaussView的片段库里直接就有。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">tolerance 2.0</span><br><span class="line">output mix.pdb</span><br><span class="line">structure chloroform.pdb</span><br><span class="line"> number 200</span><br><span class="line"> inside box 0. 0. 0. 40. 40. 20.</span><br><span class="line"> inside sphere 20. 20. 20. 15.</span><br><span class="line">end structure</span><br><span class="line">structure methanol.pdb</span><br><span class="line"> number 200</span><br><span class="line"> inside box 0. 0. 20. 40. 40. 40.</span><br><span class="line"> inside sphere 20. 20. 20. 15.</span><br><span class="line">end structure</span><br><span class="line">structure C60.pdb</span><br><span class="line">number 1</span><br><span class="line">center</span><br><span class="line">fixed 20. 20. 20. 0. 0. 0.</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>此例我们假定球的中心在(2,2,2) nm的位置，因此直接用center和fixed关键词将C60的中心定位在这个地方。对于氯仿和甲醇，inside sphere要求它们只能出现于距离(2,2,2)半径1.5 nm的区域内，由于二者的inside box设定范围正好相接，因此这两种分子会分布出现在Z=2 nm平面的上、下两侧。由于当前模拟的是孤立体系，所以没有用add_box_sides关键词来产生盒子信息。</p><p>用VMD观看得到的pdb文件，如下所示</p><p><img src="/images/ball.bmp" alt="img"></p><h3 id="2-4-构建水球-十二烷基磺酸钠">2.4 构建水球+十二烷基磺酸钠</h3><p>这个例子主要用来体现怎么使用原子设定。十二烷基磺酸钠(SDS’)的头部基团是亲水的，烷烃尾巴是疏水的。此例我们要构建一个半径为20 Å的水球，让100个SDS’绕着它分布，SDS’的头部基团都埋在水球里，而且让烷烃尾巴的方向基本上垂直于水球的界面，最终构建出的结构应该类似于海胆，SDS’就是海胆的刺。</p><p>我们先用GaussView画一个SDS’。由于钠离子的位置放在哪可能凭直觉不好确定，因此画完之后可以做一下几何优化，比如用Gaussian在PM7半经验方法下粗略优化后得到如下结构，看起来很合理</p><p><img src="http://sobereva.com/images/473/5.png" alt="img"></p><p>创建packmol输入文件，内容如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">tolerance 2.0</span><br><span class="line">output mix.pdb</span><br><span class="line">structure water.pdb</span><br><span class="line"> number 1200</span><br><span class="line"> inside sphere 0. 0. 0. 20.</span><br><span class="line">end structure</span><br><span class="line"></span><br><span class="line">structure SDS.pdb</span><br><span class="line">number 100</span><br><span class="line">atoms 42</span><br><span class="line"> inside sphere 0. 0. 0. 15.</span><br><span class="line">end atoms</span><br><span class="line">atoms 1</span><br><span class="line"> outside sphere 0. 0. 0. 30.</span><br><span class="line">end atoms</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>创建水球那部分没什么好说的，经测试差不多最多就能放1200个水，再多就很难产生成功了。安置SDS’的这一段值得提一下。我们让42号原子，即钠离子必须出现在距离水球中心15 Å范围以内，而让1号原子，即烃链最末端的碳原子必须距离水球中心30 Å以上。由于在SDS’中这俩原子距离为18 Å，仅略大于30-15=15 Å，因此这么定义可以起到让SDS’链垂直于水球界面的效果。</p><p>在VMD里绘制产生后的pdb，如下所示，结构完全达到了我们的期望。</p><p><img src="/images/sea_urchin.bmp" alt="img"></p><p><a href="http://m3g.iqm.unicamp.br/packmol/examples.shtml">官网</a>上也有一些例子，有兴趣可以看看。</p><h2 id="3-相关问题-注意事项">3. 相关问题&amp;注意事项</h2><p>这里说一些使用Packmol建模应当注意的问题，并且结合最主流的分子动力学程序GROMACS说一些相关事项。</p><p>Packmol的执行过程实际上是个循环过程，如果你当前的空间范围设定比较简单，Packmol很快就会顺利产生最终结构。空间约束设定得越多、越复杂，往往成功产生结构需要的循环次数越多，总耗时越高。如果你把空间范围约束得过度复杂甚至相互矛盾，或者要加入的分子数较多但允许分子出现的空间范围相对而言过度狭小，那么Packmol会反复循环，一直也收敛不了，或者最终宣告产生失败。碰到这种情况，应当将约束条件适当放宽、简化，或者设的分子数少一点再试。</p><p>一般情况下，用Packmol构建的体系肯定是比较松散的，或者说其密度肯定显著低于真实密度，因为此时还没有考虑分子间相互作用、构象的变化从而使得分子间能够接触得更紧密。但这没关系，在NPT下跑一下MD就好了，盒子尺寸会自发进行调节。而直接用Packmol产生的结构做NVT模拟一般是无意义的，因为跑起来之后分子会自发紧密聚集，其它地方就成了真空区了，和实际不符。</p><p>用Packmol实现构建含有Na<sup>+</sup>、Cl<sup>-</sup>离子的溶液体系是可以的。但是肯定没有用GROMACS里专用的<code>gmx genion</code>命令好，因为<code>gmx genion</code>在插入时会考虑体系电荷分布，会把阳离子和阴离子分别加入到静电势较负和较正的地方，这样比较合理。而Packmol则没有考虑这点，并且有可能比如产生的结构里恰好Na<sup>+</sup>出现在显著带正电荷的区域，这可能会令模拟初期稳定性较差（此时需要用较谨慎的模拟参数，比如小步长）。</p><p>虽然也可以用Packmol构建蛋白质、核酸浸在溶剂环境中的体系，但是这样做明显不如用动力学程序自带的专用做这种事情的程序好，因为Packmol产生的水的密度偏低，水的分布特征和实际体相水相差较大，可能NPT模拟起来之后盒子变形、收缩得厉害，出现溶质与其镜像最近距离太近之类问题。而如果用比如GROMACS里的<code>gmx solvate</code>命令给蛋白质/核酸加溶剂，由于是直接用事先已经做NPT平衡好的溶剂盒子（比如加水一般用自带的spc216.gro）通过平移复制来填充真空区，加的溶剂的分布状态明显理想得多得多。</p><p>GROMACS有一个命令叫<code>gmx insert-molecules</code>，可以由用户提供分子结构文件、指定插入盒子的分子数，然后试图将这些分子都插入盒子（但如果设的数目太多，会能插入多少就插入多少）。此命令远没有Packmol那么灵活，它能做的事用Packmol都可以实现，而且Packmol会通过优化算法试图让分子尽可能好地堆叠，因此对于同样的盒子范围，靠Packmol最多能插入的分子数比用gmx insert-molecules明显要多，故能得到更紧凑的结构。</p><p>Packmol原理上也可以产生磷脂双分子膜，乃至膜蛋白这样的体系的，但是这需要设置很多约束条件才能产生靠谱的结果，而且耗时很高，结果也不理想。比如磷脂之间或者磷脂与蛋白之间会有好多空隙，这会导致模拟刚开始就有水大量跑进疏水区，后续模拟将毫无意义。构建磷脂膜我最推荐用我写的genmixmem程序，速度很快，用着很方便，结合GROMACS模拟磷脂体系特别容易，详见<a href="http://sobereva.com/245">《生成混合组分的磷脂双层膜结构文件的工具genmixmem》</a>。至于产生膜蛋白，我最推荐使用GROMACS可以实现的membed方法，在北京科音动力学与GROMACS培训班里会演示操作。</p><p>如果你要建模的是分子团簇，用于构型搜索之类目的，用笔者开发的genmer比使用Packmol好得多，一次可以产生一大批，输入文件写起来省事得多，参见<a href="http://bbs.keinsci.com/thread-2369-1-1.html">《genmer：生成团簇初始构型结合molclus做团簇结构搜索的超便捷工具》</a>。</p><p>如果你用Packmol建模的目的是之后用GROMACS做模拟，别忘了GROMACS的拓扑文件里[molecules]字段里的分子按顺序完全展开后，原子的顺序必须和结构文件完全相同。为保证这一点，用于Packmol建模的分子结构文件里的原子顺序首先就得和这个分子的拓扑信息（具体来说是[atoms]字段）相对应。</p><blockquote><p>原文链接（有修改）：<a href="http://sobereva.com/473">http://sobereva.com/473</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Molecular_dynamics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vasp学习备忘录（5）——Phonopy计算热力学校正</title>
      <link href="/posts/98801124/"/>
      <url>/posts/98801124/</url>
      
        <content type="html"><![CDATA[<h2 id="1-结构优化-略">1.结构优化（略）</h2><h2 id="2-声子本征振动频率的计算">2.声子本征振动频率的计算</h2><p>这里我们需要用到phonopy软件：<a href="http://phonopy.github.io/phonopy/%E3%80%82">http://phonopy.github.io/phonopy/。</a></p><p>在以下过程中，使用 conda 的环境（请参阅 <a href="https://github.com/conda-forge/miniforge">miniforge</a>）来不干扰 现有环境（主要是 Python 环境）。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n phonopy -c conda-forge</span><br><span class="line">conda activate phonopy</span><br><span class="line">conda install -c conda-forge phonopy</span><br></pre></td></tr></table></figure><p>要退出此 conda 的环境，请执行以下作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure><p>要使用此 phonopy，必须进入此环境，如下所示。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">conda activate phonopy</span><br><span class="line">(phonopy) % phonopy</span><br><span class="line">        _</span><br><span class="line">  _ __ | |__   ___  _ __   ___   _ __  _   _</span><br><span class="line"> | <span class="string">&#x27;_ \| &#x27;</span>_ \ / _ \| <span class="string">&#x27;_ \ / _ \ | &#x27;</span>_ \| | | |</span><br><span class="line"> | |_) | | | | (_) | | | | (_) || |_) | |_| |</span><br><span class="line"> | .__/|_| |_|\___/|_| |_|\___(_) .__/ \__, |</span><br><span class="line"> |_|                            |_|    |___/</span><br><span class="line">                                      2.12.0</span><br><span class="line"></span><br><span class="line">Python version 3.9.6</span><br><span class="line">Spglib version 1.16.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Supercell matrix (DIM or --dim) was not explicitly specified.</span><br><span class="line">By this reason, phonopy_yaml mode was invoked.</span><br><span class="line">But <span class="string">&quot;phonopy_params.yaml&quot;</span>, <span class="string">&quot;phonopy_disp.yaml&quot;</span> and <span class="string">&quot;phonopy.yaml&quot;</span> could not be found.</span><br><span class="line">  ___ _ __ _ __ ___  _ __</span><br><span class="line"> / _ \ <span class="string">&#x27;__| &#x27;</span>__/ _ \| <span class="string">&#x27;__|</span></span><br><span class="line"><span class="string">|  __/ |  | | | (_) | |</span></span><br><span class="line"><span class="string"> \___|_|  |_|  \___/|_|</span></span><br></pre></td></tr></table></figure><h3 id="a-准备poscar文件">a. 准备POSCAR文件</h3><p>运行命令：</p><p><code>mv CONTCAR POSCAR_unitcell</code></p><p><code>phonopy-load -d --dim=&quot;2 2 2&quot; -c POSCAR_unitcell</code></p><p><code>cp SPOSCAR POSCAR</code></p><p>注：第一条命令中的POSCAR是结构弛豫后的CONTCAR。</p><h3 id="b-准备incar文件">b. 准备INCAR文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IBRION = 8 #DPFT计算</span><br><span class="line">SIGMA = 0.1 #Gamma点有虚频时可适当增大</span><br><span class="line">NSW =1   </span><br><span class="line">EDIFF = 1E-8  </span><br></pre></td></tr></table></figure><h3 id="c-准备kpoints文件">c. 准备KPOINTS文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">K-Spacing Value to Generate K-Mesh: 0.040</span><br><span class="line">0</span><br><span class="line">Gamma</span><br><span class="line">   3   3   3    #自洽计算的K点密度一致</span><br><span class="line">0.0  0.0  0.0 </span><br></pre></td></tr></table></figure><h3 id="d-提交任务-调用vasp计算">d. 提交任务，调用VASP计算</h3><h3 id="e-虚频检查">e. 虚频检查</h3><p><code>grep THz OUTCAR</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"> 1 f  =   10.268932 THz    64.521601 2PiTHz  342.534694 cm-1    42.468870 meV</span><br><span class="line"> 2 f  =   10.268932 THz    64.521601 2PiTHz  342.534694 cm-1    42.468870 meV</span><br><span class="line"> 3 f  =   10.268932 THz    64.521601 2PiTHz  342.534694 cm-1    42.468870 meV</span><br><span class="line"> 4 f  =    9.823664 THz    61.723899 2PiTHz  327.682146 cm-1    40.627390 meV</span><br><span class="line"> 5 f  =    9.823664 THz    61.723899 2PiTHz  327.682146 cm-1    40.627390 meV</span><br><span class="line"> 6 f  =    9.823664 THz    61.723899 2PiTHz  327.682146 cm-1    40.627390 meV</span><br><span class="line"> 7 f  =    9.823664 THz    61.723899 2PiTHz  327.682146 cm-1    40.627390 meV</span><br><span class="line"> 8 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line"> 9 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">10 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">11 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">12 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">13 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">14 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">15 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">16 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">17 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">18 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">19 f  =    7.989614 THz    50.200228 2PiTHz  266.504851 cm-1    33.042375 meV</span><br><span class="line">20 f  =    6.801072 THz    42.732396 2PiTHz  226.859346 cm-1    28.126961 meV</span><br><span class="line">21 f  =    6.801072 THz    42.732396 2PiTHz  226.859346 cm-1    28.126961 meV</span><br><span class="line">22 f  =    6.801072 THz    42.732396 2PiTHz  226.859346 cm-1    28.126961 meV</span><br><span class="line">23 f  =    6.801072 THz    42.732396 2PiTHz  226.859346 cm-1    28.126961 meV</span><br><span class="line">24 f  =    6.801072 THz    42.732396 2PiTHz  226.859346 cm-1    28.126961 meV</span><br><span class="line">25 f  =    6.801072 THz    42.732396 2PiTHz  226.859346 cm-1    28.126961 meV</span><br><span class="line">26 f  =    6.393956 THz    40.174410 2PiTHz  213.279413 cm-1    26.443265 meV</span><br><span class="line">27 f  =    6.393956 THz    40.174410 2PiTHz  213.279413 cm-1    26.443265 meV</span><br><span class="line">28 f  =    6.393956 THz    40.174410 2PiTHz  213.279413 cm-1    26.443265 meV</span><br><span class="line">29 f  =    6.393956 THz    40.174410 2PiTHz  213.279413 cm-1    26.443265 meV</span><br><span class="line">30 f  =    6.393956 THz    40.174410 2PiTHz  213.279413 cm-1    26.443265 meV</span><br><span class="line">31 f  =    6.393956 THz    40.174410 2PiTHz  213.279413 cm-1    26.443265 meV</span><br><span class="line">32 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">33 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">34 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">35 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">36 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">37 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">38 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">39 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">40 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">41 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">42 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">43 f  =    6.373705 THz    40.047170 2PiTHz  212.603917 cm-1    26.359514 meV</span><br><span class="line">44 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">45 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">46 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">47 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">48 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">49 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">50 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">51 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">52 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">53 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">54 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">55 f  =    5.567004 THz    34.978517 2PiTHz  185.695262 cm-1    23.023268 meV</span><br><span class="line">56 f  =    4.687675 THz    29.453532 2PiTHz  156.364014 cm-1    19.386658 meV</span><br><span class="line">57 f  =    4.687675 THz    29.453532 2PiTHz  156.364014 cm-1    19.386658 meV</span><br><span class="line">58 f  =    4.687675 THz    29.453532 2PiTHz  156.364014 cm-1    19.386658 meV</span><br><span class="line">59 f  =    4.687675 THz    29.453532 2PiTHz  156.364014 cm-1    19.386658 meV</span><br><span class="line">60 f  =    4.687675 THz    29.453532 2PiTHz  156.364014 cm-1    19.386658 meV</span><br><span class="line">61 f  =    4.687675 THz    29.453532 2PiTHz  156.364014 cm-1    19.386658 meV</span><br><span class="line">62 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">63 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">64 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">65 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">66 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">67 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">68 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">69 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">70 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">71 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">72 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">73 f  =    4.319432 THz    27.139792 2PiTHz  144.080742 cm-1    17.863727 meV</span><br><span class="line">74 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">75 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">76 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">77 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">78 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">79 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">80 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">81 f  =    4.131167 THz    25.956886 2PiTHz  137.800888 cm-1    17.085125 meV</span><br><span class="line">82 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">83 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">84 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">85 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">86 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">87 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">88 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">89 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">90 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">91 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">92 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">93 f  =    4.066969 THz    25.553517 2PiTHz  135.659469 cm-1    16.819623 meV</span><br><span class="line">94 f/i=    0.000001 THz     0.000005 2PiTHz    0.000027 cm-1     0.000003 meV</span><br><span class="line">95 f/i=    0.000001 THz     0.000005 2PiTHz    0.000027 cm-1     0.000003 meV</span><br><span class="line">96 f/i=    0.000001 THz     0.000005 2PiTHz    0.000028 cm-1     0.000003 meV</span><br></pre></td></tr></table></figure><p>如果上面f的位置是f/i，说明是虚频。</p><p>注：查看是否有虚频，如果在Gama点有虚频，增加电子步精度或者增大SIGMA重新计算。如果其他位置有虚频，需要进一步扩胞，主要是大的虚频，很小的虚频不用管。</p><p>上面图中的每一行是一个振动频率。等号后面第一列值是ω，第二列是2πω，这两列的单位都是THz。第三列是波长的倒数1/λ，是根据1/ω=λ/c (c:光速)计算出来的，单位是cm<sup>-1</sup>。最后一列是ћω，单位是meV。总共有3N行，即总共有3N个振动频率。N是POSCAR中原子的个数。</p><h2 id="3-声子零点振动能zpe和吉布斯自由能的计算">3.声子零点振动能ZPE和吉布斯自由能的计算</h2><p>根据ZPE和G的表达式（详细推导见我们上一期公众号，<a href="http://mp.weixin.qq.com/s?__biz=MzkyODI1MDkzMQ==&amp;mid=2247483745&amp;idx=1&amp;sn=6d778b432d19423188077b703dd2dca1&amp;chksm=c21aec3df56d652bc30408adaed234b6d1cc0bc7c23bfc816251ab5775cbbb999b6c8ab76cdb&amp;scene=21#wechat_redirect">点击链接查看</a>）：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mi>P</mi><mi>E</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mn>3</mn><mi>N</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">ℏ</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><mn>2</mn></mfrac><mspace linebreak="newline"></mspace><mi>G</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mn>3</mn><mi>N</mi></mrow></munderover><mfrac><mrow><mi mathvariant="normal">ℏ</mi><msub><mi>ω</mi><mi>i</mi></msub></mrow><mn>2</mn></mfrac><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mn>3</mn><mi>N</mi></mrow></munderover><mi>k</mi><mi>T</mi><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi mathvariant="normal">ℏ</mi><msub><mi>ω</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>K</mi><mi>T</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ZPE=\sum_{i=1}^{3N}\frac{\hbar\omega_{i}}{2}\\G=\sum_{i=1}^{3N}\frac{\hbar\omega_{i}}{2}+\sum_{i=1}^{3N}kT\mathrm{ln}(1-e^{-\hbar\omega_{i}/KT})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36589em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">ℏ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36589em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">ℏ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathrm">l</span><span class="mord mathrm">n</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">ℏ</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>因此，我们只需要将输出的3N个ћω相加除2即可得到声子的零点振动能ZPE。G相对复杂一点。我们可以借助Excel得到G与温度的关系。</p><p>当然，如果你嫌麻烦，phonopy可以干这些活。</p><h3 id="a-输出力常数">a. 输出力常数</h3><p>在你计算声子振动频率的这个文件夹中运行命令：</p><p><code>phonopy-load --fc vasprun.xml</code></p><p>文件夹中将出现这个FORCE_CONSTANTS文件，这就是力常数文件。</p><h3 id="b-输出热学性质-包括自由能g">b. 输出热学性质（包括自由能G）</h3><p>准备一个文件，文件名随意，这里我们用mesh.conf，</p><p><code>vim mesh.conf</code></p><p>写入如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ATOM_NAME = Al</span><br><span class="line">DIM = 2 2 2</span><br><span class="line">MP = 3 3 3  </span><br><span class="line">FORCE_CONSTANTS = READ</span><br><span class="line">TPROP = .TRUE.</span><br><span class="line">TMIN  = 0  </span><br><span class="line">TSTEP = 10 </span><br><span class="line">TMAX  = 3000  </span><br></pre></td></tr></table></figure><p>运行命令：</p><p><code>phonopy-load -t mesh.conf -c  POSCAR_unitcell</code></p><p>出现thermal_properties.yaml文件，里面包含ZPE、自由能、熵、热容量、内能。其中，自由能（phonopy称亥姆霍兹自由能）就是我们要求的吉布斯自由能G。</p><p>为了绘图方便，接着输入如下命令，将thermal_properties.yaml文件转换成thermal.dat文件.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phonopy-propplot --gnuplot thermal_properties.yaml &gt; thermal.dat</span><br></pre></td></tr></table></figure><blockquote><p>原文链接（有修改）：<a href="https://mp.weixin.qq.com/s/2uJtj6wEKAAqYwAMgvTi1A">https://mp.weixin.qq.com/s/2uJtj6wEKAAqYwAMgvTi1A</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> DFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vasp学习备忘录（4）——Vasp脚本</title>
      <link href="/posts/b1c3ce82/"/>
      <url>/posts/b1c3ce82/</url>
      
        <content type="html"><![CDATA[<h2 id="截断能测试">截断能测试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">list=`<span class="built_in">seq</span> 150 50 400`</span><br><span class="line"><span class="built_in">rm</span> WAVECAR</span><br><span class="line"><span class="built_in">rm</span> ENCUTOFF</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$list</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">cat</span> &gt; INCAR &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">System = Si</span></span><br><span class="line"><span class="string">ENCUT = $i</span></span><br><span class="line"><span class="string">ISTART = 0</span></span><br><span class="line"><span class="string">ICHARG = 2</span></span><br><span class="line"><span class="string">ISMEAR = 0</span></span><br><span class="line"><span class="string">SIGMA = 0.1</span></span><br><span class="line"><span class="string">PREC = Accurate</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Running VASP with ENCUT = <span class="variable">$i</span> eV&quot;</span></span><br><span class="line">mpirun -np 24 ~/vasp.6.3.2/bin/vasp_std</span><br><span class="line">E=$(grep -i <span class="string">&quot;TOTEN&quot;</span> OUTCAR | <span class="built_in">tail</span> -1 | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line">KP=$(grep <span class="string">&quot;irreducible&quot;</span> OUTCAR | <span class="built_in">tail</span> -1 | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ENCUT: <span class="variable">$i</span> eV, Total energy: <span class="variable">$E</span>, k-points: <span class="variable">$KP</span>&quot;</span> &gt;&gt;ENCUTOFF</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">cat</span> ENCUTOFF</span><br></pre></td></tr></table></figure><h2 id="k点测试">K点测试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除旧的 WAVECAR 文件（如果存在）</span></span><br><span class="line"><span class="built_in">rm</span> -f WAVECAR</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出文件头</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;#k-mesh  Irreducible-kpoints  Total-energy(eV)&quot;</span> &gt; comment</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试不同的 k 点网格</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;6..10&#125;; <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># 生成 KPOINTS 文件</span></span><br><span class="line">    <span class="built_in">cat</span> &gt; KPOINTS &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">Automatic generation</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">Monkhorst-pack</span></span><br><span class="line"><span class="string">$i $i $i</span></span><br><span class="line"><span class="string">0.0 0.0 0.0</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Running k-mesh = <span class="variable">$&#123;i&#125;</span>x<span class="variable">$&#123;i&#125;</span>x<span class="variable">$&#123;i&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 运行 VASP (后台运行)</span></span><br><span class="line">    mpirun -np 24 ~/vasp.6.3.2/bin/vasp_std</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取结果</span></span><br><span class="line">    E=$(grep <span class="string">&quot;TOTEN&quot;</span> OUTCAR | <span class="built_in">tail</span> -1 | awk <span class="string">&#x27;&#123;printf &quot;%12.6f&quot;, $5&#125;&#x27;</span>)</span><br><span class="line">    KP=$(grep <span class="string">&quot;irreducible&quot;</span> OUTCAR | <span class="built_in">tail</span> -1 | awk <span class="string">&#x27;&#123;printf &quot;%5i&quot;, $2&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 记录结果</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%3i %12i %12.6f\n&quot;</span> <span class="variable">$i</span> <span class="variable">$KP</span> <span class="variable">$E</span> &gt;&gt; comment</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Completed k-mesh <span class="variable">$&#123;i&#125;</span>x<span class="variable">$&#123;i&#125;</span>x<span class="variable">$&#123;i&#125;</span>: Irreducible k-points = <span class="variable">$KP</span>, Energy = <span class="variable">$E</span> eV&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;All calculations completed. Results saved in &#x27;comment&#x27; file.&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> DFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习记录（1）——脚本处理微分电容（dQ/dV）曲线</title>
      <link href="/posts/d8b9edbc/"/>
      <url>/posts/d8b9edbc/</url>
      
        <content type="html"><![CDATA[<p>代码根据编辑之谭展示的Matlab代码进行改写，具体原理可以参考谭编的公众号推文：<br><a href="https://mp.weixin.qq.com/s/qWDuB1fwpWMTfZjDxEMaiA">https://mp.weixin.qq.com/s/qWDuB1fwpWMTfZjDxEMaiA</a></p><h2 id="脚本代码：">脚本代码：</h2><p>**注:**由于是跳点进行求导，d=30时结尾存在30个点无法进行与后面的数据进行求导，导致数据缺失。因次d值过大会导致明显的数据缺失，可通过增加采样数据数量和减小d值来缓解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment"># 推荐使用SimHei字体显示中文</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span> <span class="comment"># 解决保存图像是负号&#x27;-&#x27;显示为方块的问题</span></span><br><span class="line"><span class="comment"># 读取 Excel 文件</span></span><br><span class="line">d = <span class="number">30</span> <span class="comment">#间隔30个点，进行求导，如果曲线毛刺较多可以适当增大数值。</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;原始数据.xlsx&#x27;</span>)</span><br><span class="line">A = df.values</span><br><span class="line">n = A.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法1：平均求导法</span></span><br><span class="line">C = np.zeros((<span class="built_in">len</span>(A[:, <span class="number">0</span>]) - d, n))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(A[:, <span class="number">0</span>]) - d):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n // <span class="number">2</span>):</span><br><span class="line">        C[i, <span class="number">2</span>*j] = (A[i, <span class="number">2</span>*j] + A[i+d, <span class="number">2</span>*j]) / <span class="number">2</span>  </span><br><span class="line">        C[i, <span class="number">2</span>*j+<span class="number">1</span>] = (A[i+d, <span class="number">2</span>*j+<span class="number">1</span>] - A[i, <span class="number">2</span>*j+<span class="number">1</span>]) / (A[i+d, <span class="number">2</span>*j] - A[i, <span class="number">2</span>*j])  <span class="comment"># 调整索引以匹配 MATLAB 逻辑</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2：交叉求导法</span></span><br><span class="line">D = np.zeros((<span class="built_in">len</span>(A[:, <span class="number">0</span>]) - d, n))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(A[:, <span class="number">0</span>]) - d):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n // <span class="number">2</span>):</span><br><span class="line">        D[i, <span class="number">2</span>*j] = A[i+d//<span class="number">2</span>, <span class="number">2</span>*j]</span><br><span class="line">        D[i, <span class="number">2</span>*j+<span class="number">1</span>] = (A[i+d, <span class="number">2</span>*j+<span class="number">1</span>] - A[i, <span class="number">2</span>*j+<span class="number">1</span>]) / (A[i+d, <span class="number">2</span>*j] - A[i, <span class="number">2</span>*j])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法3：两种方法取均值</span></span><br><span class="line">E = <span class="number">0.5</span> * (C[:<span class="built_in">min</span>(<span class="built_in">len</span>(C[:, <span class="number">0</span>]), <span class="built_in">len</span>(D[:, <span class="number">0</span>])), :] + D[:<span class="built_in">min</span>(<span class="built_in">len</span>(C[:, <span class="number">0</span>]), <span class="built_in">len</span>(D[:, <span class="number">0</span>])), :])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图方法1</span></span><br><span class="line">fig,axs=plt.subplots(<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n // <span class="number">2</span>):</span><br><span class="line">    axs[<span class="number">0</span>].plot(C[:, <span class="number">2</span>*j], C[:, <span class="number">2</span>*j+<span class="number">1</span>])</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&#x27;方法1：平均求导法&#x27;</span>)</span><br><span class="line">axs[<span class="number">0</span>].legend([<span class="string">&#x27;第&#123;&#125;次充电&#x27;</span>.<span class="built_in">format</span>(j+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">4</span>)] + [<span class="string">&#x27;第&#123;&#125;次放电&#x27;</span>.<span class="built_in">format</span>(j+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">4</span>)])</span><br><span class="line"><span class="comment"># 绘图方法2</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n // <span class="number">2</span>):</span><br><span class="line">    axs[<span class="number">1</span>].plot(D[:, <span class="number">2</span>*j], D[:, <span class="number">2</span>*j+<span class="number">1</span>])</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&#x27;方法2：交叉求导法&#x27;</span>)</span><br><span class="line">axs[<span class="number">1</span>].legend([<span class="string">&#x27;第&#123;&#125;次充电&#x27;</span>.<span class="built_in">format</span>(j+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">4</span>)] + [<span class="string">&#x27;第&#123;&#125;次放电&#x27;</span>.<span class="built_in">format</span>(j+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">4</span>)])</span><br><span class="line"><span class="comment"># 绘图方法3</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n // <span class="number">2</span>):</span><br><span class="line">    axs[<span class="number">2</span>].plot(E[:, <span class="number">2</span>*j], E[:, <span class="number">2</span>*j+<span class="number">1</span>])</span><br><span class="line">axs[<span class="number">2</span>].set_title(<span class="string">&#x27;方法3：两种方法取均值&#x27;</span>)</span><br><span class="line">axs[<span class="number">2</span>].legend([<span class="string">&#x27;第&#123;&#125;次充电&#x27;</span>.<span class="built_in">format</span>(j+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">4</span>)] + [<span class="string">&#x27;第&#123;&#125;次放电&#x27;</span>.<span class="built_in">format</span>(j+<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">4</span>)])</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">df1=pd.DataFrame(C)</span><br><span class="line">df2=pd.DataFrame(D)</span><br><span class="line">df3=pd.DataFrame(E)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">&#x27;微分电容output.xlsx&#x27;</span>) <span class="keyword">as</span> writer:  </span><br><span class="line">    df1.to_excel(writer, sheet_name=<span class="string">&#x27;平均求导法&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    df2.to_excel(writer, sheet_name=<span class="string">&#x27;交叉求导法&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    df3.to_excel(writer, sheet_name=<span class="string">&#x27;两种方法取均值&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="运行结果">运行结果</h2><h3 id="1-matplotlib绘制图像">1.matplotlib绘制图像</h3><p><img src="/images/%E5%BE%AE%E5%88%86%E7%94%B5%E5%AE%B9%E6%9B%B2%E7%BA%BF.png" alt="微分电容曲线"></p><h3 id="2-输出文件">2.输出文件</h3><p>同时目录下会新生成一个“<strong>微分电容output.xlsx</strong>”的EXCEL文件。</p><h3 id="3-输入数据：">3.输入数据：</h3><p>数据保存为“<strong>原始数据.xlsx</strong>”格式。可以在表格右侧添加多列充放电数据，一次处理不同循环圈数。下面仅给出一次充放电的数据。</p><table><thead><tr><th style="text-align:center">电压(V)</th><th style="text-align:center">比容量(mAh/g)</th><th style="text-align:center">电压(V)</th><th style="text-align:center">比容量(mAh/g)</th></tr></thead><tbody><tr><td style="text-align:center">3.6542</td><td style="text-align:center">0</td><td style="text-align:center">4.2178</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">3.6678</td><td style="text-align:center">0.0022</td><td style="text-align:center">4.2014</td><td style="text-align:center">0.0022</td></tr><tr><td style="text-align:center">3.6753</td><td style="text-align:center">0.0044</td><td style="text-align:center">4.1924</td><td style="text-align:center">0.0044</td></tr><tr><td style="text-align:center">3.679</td><td style="text-align:center">0.0066</td><td style="text-align:center">4.1859</td><td style="text-align:center">0.0066</td></tr><tr><td style="text-align:center">3.6815</td><td style="text-align:center">0.0089</td><td style="text-align:center">4.18</td><td style="text-align:center">0.0089</td></tr><tr><td style="text-align:center">3.6855</td><td style="text-align:center">0.0111</td><td style="text-align:center">4.1766</td><td style="text-align:center">0.0111</td></tr><tr><td style="text-align:center">3.6864</td><td style="text-align:center">0.0133</td><td style="text-align:center">4.1719</td><td style="text-align:center">0.0133</td></tr><tr><td style="text-align:center">3.6886</td><td style="text-align:center">0.0155</td><td style="text-align:center">4.1679</td><td style="text-align:center">0.0155</td></tr><tr><td style="text-align:center">3.6908</td><td style="text-align:center">0.0177</td><td style="text-align:center">4.1664</td><td style="text-align:center">0.0177</td></tr><tr><td style="text-align:center">3.6917</td><td style="text-align:center">0.0199</td><td style="text-align:center">4.1629</td><td style="text-align:center">0.0199</td></tr><tr><td style="text-align:center">3.6945</td><td style="text-align:center">0.0221</td><td style="text-align:center">4.1623</td><td style="text-align:center">0.0221</td></tr><tr><td style="text-align:center">3.6954</td><td style="text-align:center">0.0243</td><td style="text-align:center">4.1586</td><td style="text-align:center">0.0243</td></tr><tr><td style="text-align:center">3.6973</td><td style="text-align:center">0.0266</td><td style="text-align:center">4.1577</td><td style="text-align:center">0.0266</td></tr><tr><td style="text-align:center">3.6988</td><td style="text-align:center">0.0288</td><td style="text-align:center">4.1571</td><td style="text-align:center">0.0288</td></tr><tr><td style="text-align:center">3.701</td><td style="text-align:center">0.031</td><td style="text-align:center">4.1552</td><td style="text-align:center">0.031</td></tr><tr><td style="text-align:center">3.7019</td><td style="text-align:center">0.0332</td><td style="text-align:center">4.153</td><td style="text-align:center">0.0332</td></tr><tr><td style="text-align:center">3.7035</td><td style="text-align:center">0.0354</td><td style="text-align:center">4.1527</td><td style="text-align:center">0.0354</td></tr><tr><td style="text-align:center">3.705</td><td style="text-align:center">0.0376</td><td style="text-align:center">4.1515</td><td style="text-align:center">0.0376</td></tr><tr><td style="text-align:center">3.7066</td><td style="text-align:center">0.0398</td><td style="text-align:center">4.1505</td><td style="text-align:center">0.0398</td></tr><tr><td style="text-align:center">3.7085</td><td style="text-align:center">0.042</td><td style="text-align:center">4.1487</td><td style="text-align:center">0.042</td></tr><tr><td style="text-align:center">3.71</td><td style="text-align:center">0.0443</td><td style="text-align:center">4.1474</td><td style="text-align:center">0.0443</td></tr><tr><td style="text-align:center">3.7122</td><td style="text-align:center">0.0465</td><td style="text-align:center">4.1474</td><td style="text-align:center">0.0465</td></tr><tr><td style="text-align:center">3.714</td><td style="text-align:center">0.0487</td><td style="text-align:center">4.1459</td><td style="text-align:center">0.0487</td></tr><tr><td style="text-align:center">3.7156</td><td style="text-align:center">0.0509</td><td style="text-align:center">4.1443</td><td style="text-align:center">0.0509</td></tr><tr><td style="text-align:center">3.7171</td><td style="text-align:center">0.0531</td><td style="text-align:center">4.1428</td><td style="text-align:center">0.0531</td></tr><tr><td style="text-align:center">3.7205</td><td style="text-align:center">0.0553</td><td style="text-align:center">4.1425</td><td style="text-align:center">0.0553</td></tr><tr><td style="text-align:center">3.7209</td><td style="text-align:center">0.0575</td><td style="text-align:center">4.1406</td><td style="text-align:center">0.0575</td></tr><tr><td style="text-align:center">3.7243</td><td style="text-align:center">0.0597</td><td style="text-align:center">4.1385</td><td style="text-align:center">0.0597</td></tr><tr><td style="text-align:center">3.7255</td><td style="text-align:center">0.062</td><td style="text-align:center">4.1372</td><td style="text-align:center">0.062</td></tr><tr><td style="text-align:center">3.7274</td><td style="text-align:center">0.0642</td><td style="text-align:center">4.135</td><td style="text-align:center">0.0642</td></tr><tr><td style="text-align:center">3.7295</td><td style="text-align:center">0.0664</td><td style="text-align:center">4.1335</td><td style="text-align:center">0.0664</td></tr><tr><td style="text-align:center">3.7305</td><td style="text-align:center">0.0686</td><td style="text-align:center">4.1319</td><td style="text-align:center">0.0686</td></tr><tr><td style="text-align:center">3.732</td><td style="text-align:center">0.0708</td><td style="text-align:center">4.1292</td><td style="text-align:center">0.0708</td></tr><tr><td style="text-align:center">3.7345</td><td style="text-align:center">0.073</td><td style="text-align:center">4.1273</td><td style="text-align:center">0.073</td></tr><tr><td style="text-align:center">3.7364</td><td style="text-align:center">0.0752</td><td style="text-align:center">4.1251</td><td style="text-align:center">0.0752</td></tr><tr><td style="text-align:center">3.7391</td><td style="text-align:center">0.0774</td><td style="text-align:center">4.1226</td><td style="text-align:center">0.0774</td></tr><tr><td style="text-align:center">3.7407</td><td style="text-align:center">0.0797</td><td style="text-align:center">4.1195</td><td style="text-align:center">0.0797</td></tr><tr><td style="text-align:center">3.7426</td><td style="text-align:center">0.0819</td><td style="text-align:center">4.1168</td><td style="text-align:center">0.0819</td></tr><tr><td style="text-align:center">3.745</td><td style="text-align:center">0.0841</td><td style="text-align:center">4.114</td><td style="text-align:center">0.0841</td></tr><tr><td style="text-align:center">3.7466</td><td style="text-align:center">0.0863</td><td style="text-align:center">4.1109</td><td style="text-align:center">0.0863</td></tr><tr><td style="text-align:center">3.7485</td><td style="text-align:center">0.0885</td><td style="text-align:center">4.1078</td><td style="text-align:center">0.0885</td></tr><tr><td style="text-align:center">3.7512</td><td style="text-align:center">0.0907</td><td style="text-align:center">4.1034</td><td style="text-align:center">0.0907</td></tr><tr><td style="text-align:center">3.7522</td><td style="text-align:center">0.0929</td><td style="text-align:center">4.1009</td><td style="text-align:center">0.0929</td></tr><tr><td style="text-align:center">3.754</td><td style="text-align:center">0.0951</td><td style="text-align:center">4.0969</td><td style="text-align:center">0.0952</td></tr><tr><td style="text-align:center">3.7565</td><td style="text-align:center">0.0974</td><td style="text-align:center">4.0932</td><td style="text-align:center">0.0974</td></tr><tr><td style="text-align:center">3.7574</td><td style="text-align:center">0.0996</td><td style="text-align:center">4.0901</td><td style="text-align:center">0.0996</td></tr><tr><td style="text-align:center">3.7599</td><td style="text-align:center">0.1018</td><td style="text-align:center">4.0861</td><td style="text-align:center">0.1018</td></tr><tr><td style="text-align:center">3.7615</td><td style="text-align:center">0.104</td><td style="text-align:center">4.082</td><td style="text-align:center">0.104</td></tr><tr><td style="text-align:center">3.7636</td><td style="text-align:center">0.1062</td><td style="text-align:center">4.0786</td><td style="text-align:center">0.1062</td></tr><tr><td style="text-align:center">3.7652</td><td style="text-align:center">0.1084</td><td style="text-align:center">4.0734</td><td style="text-align:center">0.1084</td></tr><tr><td style="text-align:center">3.7661</td><td style="text-align:center">0.1106</td><td style="text-align:center">4.0681</td><td style="text-align:center">0.1106</td></tr><tr><td style="text-align:center">3.7683</td><td style="text-align:center">0.1128</td><td style="text-align:center">4.065</td><td style="text-align:center">0.1129</td></tr><tr><td style="text-align:center">3.7708</td><td style="text-align:center">0.1151</td><td style="text-align:center">4.0616</td><td style="text-align:center">0.1151</td></tr><tr><td style="text-align:center">3.7714</td><td style="text-align:center">0.1173</td><td style="text-align:center">4.0569</td><td style="text-align:center">0.1173</td></tr><tr><td style="text-align:center">3.7754</td><td style="text-align:center">0.1195</td><td style="text-align:center">4.0529</td><td style="text-align:center">0.1195</td></tr><tr><td style="text-align:center">3.776</td><td style="text-align:center">0.1217</td><td style="text-align:center">4.0476</td><td style="text-align:center">0.1217</td></tr><tr><td style="text-align:center">3.7779</td><td style="text-align:center">0.1239</td><td style="text-align:center">4.0442</td><td style="text-align:center">0.1239</td></tr><tr><td style="text-align:center">3.7801</td><td style="text-align:center">0.1261</td><td style="text-align:center">4.0414</td><td style="text-align:center">0.1261</td></tr><tr><td style="text-align:center">3.7816</td><td style="text-align:center">0.1283</td><td style="text-align:center">4.0365</td><td style="text-align:center">0.1283</td></tr><tr><td style="text-align:center">3.7835</td><td style="text-align:center">0.1305</td><td style="text-align:center">4.0321</td><td style="text-align:center">0.1306</td></tr><tr><td style="text-align:center">3.7857</td><td style="text-align:center">0.1328</td><td style="text-align:center">4.0272</td><td style="text-align:center">0.1328</td></tr><tr><td style="text-align:center">3.7866</td><td style="text-align:center">0.135</td><td style="text-align:center">4.0237</td><td style="text-align:center">0.135</td></tr><tr><td style="text-align:center">3.7875</td><td style="text-align:center">0.1372</td><td style="text-align:center">4.02</td><td style="text-align:center">0.1372</td></tr><tr><td style="text-align:center">3.7912</td><td style="text-align:center">0.1394</td><td style="text-align:center">4.016</td><td style="text-align:center">0.1394</td></tr><tr><td style="text-align:center">3.7915</td><td style="text-align:center">0.1416</td><td style="text-align:center">4.012</td><td style="text-align:center">0.1416</td></tr><tr><td style="text-align:center">3.7946</td><td style="text-align:center">0.1438</td><td style="text-align:center">4.0073</td><td style="text-align:center">0.1438</td></tr><tr><td style="text-align:center">3.7965</td><td style="text-align:center">0.146</td><td style="text-align:center">4.0051</td><td style="text-align:center">0.146</td></tr><tr><td style="text-align:center">3.7981</td><td style="text-align:center">0.1483</td><td style="text-align:center">4.0011</td><td style="text-align:center">0.1483</td></tr><tr><td style="text-align:center">3.7999</td><td style="text-align:center">0.1505</td><td style="text-align:center">3.9974</td><td style="text-align:center">0.1505</td></tr><tr><td style="text-align:center">3.8027</td><td style="text-align:center">0.1527</td><td style="text-align:center">3.9931</td><td style="text-align:center">0.1527</td></tr><tr><td style="text-align:center">3.8039</td><td style="text-align:center">0.1549</td><td style="text-align:center">3.9903</td><td style="text-align:center">0.1549</td></tr><tr><td style="text-align:center">3.8058</td><td style="text-align:center">0.1571</td><td style="text-align:center">3.9859</td><td style="text-align:center">0.1571</td></tr><tr><td style="text-align:center">3.8074</td><td style="text-align:center">0.1593</td><td style="text-align:center">3.9828</td><td style="text-align:center">0.1593</td></tr><tr><td style="text-align:center">3.8108</td><td style="text-align:center">0.1615</td><td style="text-align:center">3.9797</td><td style="text-align:center">0.1615</td></tr><tr><td style="text-align:center">3.8117</td><td style="text-align:center">0.1637</td><td style="text-align:center">3.9751</td><td style="text-align:center">0.1637</td></tr><tr><td style="text-align:center">3.8139</td><td style="text-align:center">0.166</td><td style="text-align:center">3.9723</td><td style="text-align:center">0.166</td></tr><tr><td style="text-align:center">3.816</td><td style="text-align:center">0.1682</td><td style="text-align:center">3.9689</td><td style="text-align:center">0.1682</td></tr><tr><td style="text-align:center">3.8173</td><td style="text-align:center">0.1704</td><td style="text-align:center">3.9661</td><td style="text-align:center">0.1704</td></tr><tr><td style="text-align:center">3.8207</td><td style="text-align:center">0.1726</td><td style="text-align:center">3.9617</td><td style="text-align:center">0.1726</td></tr><tr><td style="text-align:center">3.8225</td><td style="text-align:center">0.1748</td><td style="text-align:center">3.9583</td><td style="text-align:center">0.1748</td></tr><tr><td style="text-align:center">3.826</td><td style="text-align:center">0.177</td><td style="text-align:center">3.9552</td><td style="text-align:center">0.177</td></tr><tr><td style="text-align:center">3.8269</td><td style="text-align:center">0.1792</td><td style="text-align:center">3.9515</td><td style="text-align:center">0.1792</td></tr><tr><td style="text-align:center">3.83</td><td style="text-align:center">0.1814</td><td style="text-align:center">3.9478</td><td style="text-align:center">0.1814</td></tr><tr><td style="text-align:center">3.8325</td><td style="text-align:center">0.1837</td><td style="text-align:center">3.9459</td><td style="text-align:center">0.1837</td></tr><tr><td style="text-align:center">3.8349</td><td style="text-align:center">0.1859</td><td style="text-align:center">3.9404</td><td style="text-align:center">0.1859</td></tr><tr><td style="text-align:center">3.8368</td><td style="text-align:center">0.1881</td><td style="text-align:center">3.9379</td><td style="text-align:center">0.1881</td></tr><tr><td style="text-align:center">3.8399</td><td style="text-align:center">0.1903</td><td style="text-align:center">3.9342</td><td style="text-align:center">0.1903</td></tr><tr><td style="text-align:center">3.8415</td><td style="text-align:center">0.1925</td><td style="text-align:center">3.9304</td><td style="text-align:center">0.1925</td></tr><tr><td style="text-align:center">3.8446</td><td style="text-align:center">0.1947</td><td style="text-align:center">3.927</td><td style="text-align:center">0.1947</td></tr><tr><td style="text-align:center">3.8461</td><td style="text-align:center">0.1969</td><td style="text-align:center">3.9239</td><td style="text-align:center">0.1969</td></tr><tr><td style="text-align:center">3.8501</td><td style="text-align:center">0.1991</td><td style="text-align:center">3.9202</td><td style="text-align:center">0.1992</td></tr><tr><td style="text-align:center">3.8523</td><td style="text-align:center">0.2014</td><td style="text-align:center">3.9165</td><td style="text-align:center">0.2014</td></tr><tr><td style="text-align:center">3.8566</td><td style="text-align:center">0.2036</td><td style="text-align:center">3.9125</td><td style="text-align:center">0.2036</td></tr><tr><td style="text-align:center">3.8582</td><td style="text-align:center">0.2058</td><td style="text-align:center">3.9081</td><td style="text-align:center">0.2058</td></tr><tr><td style="text-align:center">3.8616</td><td style="text-align:center">0.208</td><td style="text-align:center">3.9053</td><td style="text-align:center">0.208</td></tr><tr><td style="text-align:center">3.865</td><td style="text-align:center">0.2102</td><td style="text-align:center">3.9022</td><td style="text-align:center">0.2102</td></tr><tr><td style="text-align:center">3.8675</td><td style="text-align:center">0.2124</td><td style="text-align:center">3.8976</td><td style="text-align:center">0.2124</td></tr><tr><td style="text-align:center">3.8709</td><td style="text-align:center">0.2146</td><td style="text-align:center">3.8938</td><td style="text-align:center">0.2146</td></tr><tr><td style="text-align:center">3.8756</td><td style="text-align:center">0.2168</td><td style="text-align:center">3.8904</td><td style="text-align:center">0.2169</td></tr><tr><td style="text-align:center">3.8774</td><td style="text-align:center">0.2191</td><td style="text-align:center">3.887</td><td style="text-align:center">0.2191</td></tr><tr><td style="text-align:center">3.8805</td><td style="text-align:center">0.2213</td><td style="text-align:center">3.8821</td><td style="text-align:center">0.2213</td></tr><tr><td style="text-align:center">3.8845</td><td style="text-align:center">0.2235</td><td style="text-align:center">3.878</td><td style="text-align:center">0.2235</td></tr><tr><td style="text-align:center">3.888</td><td style="text-align:center">0.2257</td><td style="text-align:center">3.8752</td><td style="text-align:center">0.2257</td></tr><tr><td style="text-align:center">3.8914</td><td style="text-align:center">0.2279</td><td style="text-align:center">3.8712</td><td style="text-align:center">0.2279</td></tr><tr><td style="text-align:center">3.8951</td><td style="text-align:center">0.2301</td><td style="text-align:center">3.8669</td><td style="text-align:center">0.2301</td></tr><tr><td style="text-align:center">3.8976</td><td style="text-align:center">0.2323</td><td style="text-align:center">3.8619</td><td style="text-align:center">0.2323</td></tr><tr><td style="text-align:center">3.9016</td><td style="text-align:center">0.2345</td><td style="text-align:center">3.8594</td><td style="text-align:center">0.2346</td></tr><tr><td style="text-align:center">3.9053</td><td style="text-align:center">0.2368</td><td style="text-align:center">3.8548</td><td style="text-align:center">0.2368</td></tr><tr><td style="text-align:center">3.9094</td><td style="text-align:center">0.239</td><td style="text-align:center">3.8517</td><td style="text-align:center">0.239</td></tr><tr><td style="text-align:center">3.9121</td><td style="text-align:center">0.2412</td><td style="text-align:center">3.8467</td><td style="text-align:center">0.2412</td></tr><tr><td style="text-align:center">3.9168</td><td style="text-align:center">0.2434</td><td style="text-align:center">3.8433</td><td style="text-align:center">0.2434</td></tr><tr><td style="text-align:center">3.9208</td><td style="text-align:center">0.2456</td><td style="text-align:center">3.8396</td><td style="text-align:center">0.2456</td></tr><tr><td style="text-align:center">3.9242</td><td style="text-align:center">0.2478</td><td style="text-align:center">3.8356</td><td style="text-align:center">0.2478</td></tr><tr><td style="text-align:center">3.928</td><td style="text-align:center">0.25</td><td style="text-align:center">3.8318</td><td style="text-align:center">0.25</td></tr><tr><td style="text-align:center">3.9314</td><td style="text-align:center">0.2522</td><td style="text-align:center">3.8275</td><td style="text-align:center">0.2523</td></tr><tr><td style="text-align:center">3.9357</td><td style="text-align:center">0.2545</td><td style="text-align:center">3.8241</td><td style="text-align:center">0.2545</td></tr><tr><td style="text-align:center">3.9391</td><td style="text-align:center">0.2567</td><td style="text-align:center">3.8198</td><td style="text-align:center">0.2567</td></tr><tr><td style="text-align:center">3.9435</td><td style="text-align:center">0.2589</td><td style="text-align:center">3.816</td><td style="text-align:center">0.2589</td></tr><tr><td style="text-align:center">3.9469</td><td style="text-align:center">0.2611</td><td style="text-align:center">3.8129</td><td style="text-align:center">0.2611</td></tr><tr><td style="text-align:center">3.9512</td><td style="text-align:center">0.2633</td><td style="text-align:center">3.8095</td><td style="text-align:center">0.2633</td></tr><tr><td style="text-align:center">3.9552</td><td style="text-align:center">0.2655</td><td style="text-align:center">3.8055</td><td style="text-align:center">0.2655</td></tr><tr><td style="text-align:center">3.9583</td><td style="text-align:center">0.2677</td><td style="text-align:center">3.8021</td><td style="text-align:center">0.2677</td></tr><tr><td style="text-align:center">3.9621</td><td style="text-align:center">0.2699</td><td style="text-align:center">3.7993</td><td style="text-align:center">0.27</td></tr><tr><td style="text-align:center">3.9658</td><td style="text-align:center">0.2722</td><td style="text-align:center">3.7956</td><td style="text-align:center">0.2722</td></tr><tr><td style="text-align:center">3.9698</td><td style="text-align:center">0.2744</td><td style="text-align:center">3.7922</td><td style="text-align:center">0.2744</td></tr><tr><td style="text-align:center">3.9729</td><td style="text-align:center">0.2766</td><td style="text-align:center">3.7881</td><td style="text-align:center">0.2766</td></tr><tr><td style="text-align:center">3.9769</td><td style="text-align:center">0.2788</td><td style="text-align:center">3.7863</td><td style="text-align:center">0.2788</td></tr><tr><td style="text-align:center">3.9803</td><td style="text-align:center">0.281</td><td style="text-align:center">3.7829</td><td style="text-align:center">0.281</td></tr><tr><td style="text-align:center">3.9838</td><td style="text-align:center">0.2832</td><td style="text-align:center">3.7804</td><td style="text-align:center">0.2832</td></tr><tr><td style="text-align:center">3.9881</td><td style="text-align:center">0.2854</td><td style="text-align:center">3.7767</td><td style="text-align:center">0.2854</td></tr><tr><td style="text-align:center">3.9912</td><td style="text-align:center">0.2877</td><td style="text-align:center">3.7742</td><td style="text-align:center">0.2877</td></tr><tr><td style="text-align:center">3.9946</td><td style="text-align:center">0.2899</td><td style="text-align:center">3.7702</td><td style="text-align:center">0.2899</td></tr><tr><td style="text-align:center">3.9977</td><td style="text-align:center">0.2921</td><td style="text-align:center">3.7683</td><td style="text-align:center">0.2921</td></tr><tr><td style="text-align:center">4.0024</td><td style="text-align:center">0.2943</td><td style="text-align:center">3.7661</td><td style="text-align:center">0.2943</td></tr><tr><td style="text-align:center">4.0051</td><td style="text-align:center">0.2965</td><td style="text-align:center">3.7627</td><td style="text-align:center">0.2965</td></tr><tr><td style="text-align:center">4.0073</td><td style="text-align:center">0.2987</td><td style="text-align:center">3.7599</td><td style="text-align:center">0.2987</td></tr><tr><td style="text-align:center">4.012</td><td style="text-align:center">0.3009</td><td style="text-align:center">3.7571</td><td style="text-align:center">0.3009</td></tr><tr><td style="text-align:center">4.016</td><td style="text-align:center">0.3031</td><td style="text-align:center">3.7559</td><td style="text-align:center">0.3031</td></tr><tr><td style="text-align:center">4.0188</td><td style="text-align:center">0.3054</td><td style="text-align:center">3.7528</td><td style="text-align:center">0.3054</td></tr><tr><td style="text-align:center">4.0225</td><td style="text-align:center">0.3076</td><td style="text-align:center">3.7522</td><td style="text-align:center">0.3076</td></tr><tr><td style="text-align:center">4.0262</td><td style="text-align:center">0.3098</td><td style="text-align:center">3.7488</td><td style="text-align:center">0.3098</td></tr><tr><td style="text-align:center">4.0278</td><td style="text-align:center">0.312</td><td style="text-align:center">3.7463</td><td style="text-align:center">0.312</td></tr><tr><td style="text-align:center">4.0321</td><td style="text-align:center">0.3142</td><td style="text-align:center">3.7447</td><td style="text-align:center">0.3142</td></tr><tr><td style="text-align:center">4.0358</td><td style="text-align:center">0.3164</td><td style="text-align:center">3.741</td><td style="text-align:center">0.3164</td></tr><tr><td style="text-align:center">4.0396</td><td style="text-align:center">0.3186</td><td style="text-align:center">3.7398</td><td style="text-align:center">0.3186</td></tr><tr><td style="text-align:center">4.042</td><td style="text-align:center">0.3208</td><td style="text-align:center">3.7376</td><td style="text-align:center">0.3209</td></tr><tr><td style="text-align:center">4.0448</td><td style="text-align:center">0.3231</td><td style="text-align:center">3.7357</td><td style="text-align:center">0.3231</td></tr><tr><td style="text-align:center">4.0482</td><td style="text-align:center">0.3253</td><td style="text-align:center">3.7336</td><td style="text-align:center">0.3253</td></tr><tr><td style="text-align:center">4.0526</td><td style="text-align:center">0.3275</td><td style="text-align:center">3.7308</td><td style="text-align:center">0.3275</td></tr><tr><td style="text-align:center">4.0557</td><td style="text-align:center">0.3297</td><td style="text-align:center">3.7295</td><td style="text-align:center">0.3297</td></tr><tr><td style="text-align:center">4.0594</td><td style="text-align:center">0.3319</td><td style="text-align:center">3.7274</td><td style="text-align:center">0.3319</td></tr><tr><td style="text-align:center">4.0619</td><td style="text-align:center">0.3341</td><td style="text-align:center">3.7264</td><td style="text-align:center">0.3341</td></tr><tr><td style="text-align:center">4.0653</td><td style="text-align:center">0.3363</td><td style="text-align:center">3.7255</td><td style="text-align:center">0.3363</td></tr><tr><td style="text-align:center">4.0684</td><td style="text-align:center">0.3385</td><td style="text-align:center">3.7212</td><td style="text-align:center">0.3386</td></tr><tr><td style="text-align:center">4.0734</td><td style="text-align:center">0.3408</td><td style="text-align:center">3.7205</td><td style="text-align:center">0.3408</td></tr><tr><td style="text-align:center">4.0765</td><td style="text-align:center">0.343</td><td style="text-align:center">3.7187</td><td style="text-align:center">0.343</td></tr><tr><td style="text-align:center">4.0808</td><td style="text-align:center">0.3452</td><td style="text-align:center">3.7168</td><td style="text-align:center">0.3452</td></tr><tr><td style="text-align:center">4.0827</td><td style="text-align:center">0.3474</td><td style="text-align:center">3.7156</td><td style="text-align:center">0.3474</td></tr><tr><td style="text-align:center">4.0876</td><td style="text-align:center">0.3496</td><td style="text-align:center">3.7128</td><td style="text-align:center">0.3496</td></tr><tr><td style="text-align:center">4.0916</td><td style="text-align:center">0.3518</td><td style="text-align:center">3.7116</td><td style="text-align:center">0.3518</td></tr><tr><td style="text-align:center">4.0954</td><td style="text-align:center">0.354</td><td style="text-align:center">3.7097</td><td style="text-align:center">0.354</td></tr><tr><td style="text-align:center">4.0997</td><td style="text-align:center">0.3562</td><td style="text-align:center">3.7069</td><td style="text-align:center">0.3563</td></tr><tr><td style="text-align:center">4.1025</td><td style="text-align:center">0.3585</td><td style="text-align:center">3.7057</td><td style="text-align:center">0.3585</td></tr><tr><td style="text-align:center">4.1071</td><td style="text-align:center">0.3607</td><td style="text-align:center">3.7038</td><td style="text-align:center">0.3607</td></tr><tr><td style="text-align:center">4.1121</td><td style="text-align:center">0.3629</td><td style="text-align:center">3.7026</td><td style="text-align:center">0.3629</td></tr><tr><td style="text-align:center">4.1149</td><td style="text-align:center">0.3651</td><td style="text-align:center">3.7001</td><td style="text-align:center">0.3651</td></tr><tr><td style="text-align:center">4.1192</td><td style="text-align:center">0.3673</td><td style="text-align:center">3.6985</td><td style="text-align:center">0.3673</td></tr><tr><td style="text-align:center">4.123</td><td style="text-align:center">0.3695</td><td style="text-align:center">3.6967</td><td style="text-align:center">0.3695</td></tr><tr><td style="text-align:center">4.1276</td><td style="text-align:center">0.3717</td><td style="text-align:center">3.6951</td><td style="text-align:center">0.3717</td></tr><tr><td style="text-align:center">4.1326</td><td style="text-align:center">0.3739</td><td style="text-align:center">3.6939</td><td style="text-align:center">0.374</td></tr><tr><td style="text-align:center">4.1363</td><td style="text-align:center">0.3762</td><td style="text-align:center">3.6911</td><td style="text-align:center">0.3762</td></tr><tr><td style="text-align:center">4.1403</td><td style="text-align:center">0.3784</td><td style="text-align:center">3.6899</td><td style="text-align:center">0.3784</td></tr><tr><td style="text-align:center">4.144</td><td style="text-align:center">0.3806</td><td style="text-align:center">3.6871</td><td style="text-align:center">0.3806</td></tr><tr><td style="text-align:center">4.1481</td><td style="text-align:center">0.3828</td><td style="text-align:center">3.6855</td><td style="text-align:center">0.3828</td></tr><tr><td style="text-align:center">4.1527</td><td style="text-align:center">0.385</td><td style="text-align:center">3.6843</td><td style="text-align:center">0.385</td></tr><tr><td style="text-align:center">4.1577</td><td style="text-align:center">0.3872</td><td style="text-align:center">3.6812</td><td style="text-align:center">0.3872</td></tr><tr><td style="text-align:center">4.162</td><td style="text-align:center">0.3894</td><td style="text-align:center">3.6796</td><td style="text-align:center">0.3894</td></tr><tr><td style="text-align:center">4.1664</td><td style="text-align:center">0.3916</td><td style="text-align:center">3.6778</td><td style="text-align:center">0.3917</td></tr><tr><td style="text-align:center">4.1695</td><td style="text-align:center">0.3939</td><td style="text-align:center">3.6756</td><td style="text-align:center">0.3939</td></tr><tr><td style="text-align:center">4.1741</td><td style="text-align:center">0.3961</td><td style="text-align:center">3.674</td><td style="text-align:center">0.3961</td></tr><tr><td style="text-align:center">4.1778</td><td style="text-align:center">0.3983</td><td style="text-align:center">3.6706</td><td style="text-align:center">0.3983</td></tr><tr><td style="text-align:center">4.1825</td><td style="text-align:center">0.4005</td><td style="text-align:center">3.6691</td><td style="text-align:center">0.4005</td></tr><tr><td style="text-align:center">4.1862</td><td style="text-align:center">0.4027</td><td style="text-align:center">3.6675</td><td style="text-align:center">0.4027</td></tr><tr><td style="text-align:center">4.1908</td><td style="text-align:center">0.4049</td><td style="text-align:center">3.6644</td><td style="text-align:center">0.4049</td></tr><tr><td style="text-align:center">4.1936</td><td style="text-align:center">0.4071</td><td style="text-align:center">3.6629</td><td style="text-align:center">0.4071</td></tr><tr><td style="text-align:center">4.1964</td><td style="text-align:center">0.4094</td><td style="text-align:center">3.6601</td><td style="text-align:center">0.4094</td></tr><tr><td style="text-align:center">4.1998</td><td style="text-align:center">0.4116</td><td style="text-align:center">3.6589</td><td style="text-align:center">0.4116</td></tr><tr><td style="text-align:center">4.2042</td><td style="text-align:center">0.4138</td><td style="text-align:center">3.6558</td><td style="text-align:center">0.4138</td></tr><tr><td style="text-align:center">4.2079</td><td style="text-align:center">0.416</td><td style="text-align:center">3.6545</td><td style="text-align:center">0.416</td></tr><tr><td style="text-align:center">4.2101</td><td style="text-align:center">0.4182</td><td style="text-align:center">3.6508</td><td style="text-align:center">0.4182</td></tr><tr><td style="text-align:center">4.2132</td><td style="text-align:center">0.4204</td><td style="text-align:center">3.6492</td><td style="text-align:center">0.4204</td></tr><tr><td style="text-align:center">4.2163</td><td style="text-align:center">0.4226</td><td style="text-align:center">3.6452</td><td style="text-align:center">0.4226</td></tr><tr><td style="text-align:center">4.2184</td><td style="text-align:center">0.4248</td><td style="text-align:center">3.6437</td><td style="text-align:center">0.4248</td></tr><tr><td style="text-align:center">4.2212</td><td style="text-align:center">0.4271</td><td style="text-align:center">3.6415</td><td style="text-align:center">0.4271</td></tr><tr><td style="text-align:center">4.2237</td><td style="text-align:center">0.4293</td><td style="text-align:center">3.639</td><td style="text-align:center">0.4293</td></tr><tr><td style="text-align:center">4.2256</td><td style="text-align:center">0.4315</td><td style="text-align:center">3.6356</td><td style="text-align:center">0.4315</td></tr><tr><td style="text-align:center">4.2281</td><td style="text-align:center">0.4337</td><td style="text-align:center">3.6347</td><td style="text-align:center">0.4337</td></tr><tr><td style="text-align:center">4.2296</td><td style="text-align:center">0.4359</td><td style="text-align:center">3.6306</td><td style="text-align:center">0.4359</td></tr><tr><td style="text-align:center">4.2327</td><td style="text-align:center">0.4381</td><td style="text-align:center">3.6269</td><td style="text-align:center">0.4381</td></tr><tr><td style="text-align:center">4.2336</td><td style="text-align:center">0.4403</td><td style="text-align:center">3.6251</td><td style="text-align:center">0.4403</td></tr><tr><td style="text-align:center">4.237</td><td style="text-align:center">0.4425</td><td style="text-align:center">3.6229</td><td style="text-align:center">0.4426</td></tr><tr><td style="text-align:center">4.2392</td><td style="text-align:center">0.4448</td><td style="text-align:center">3.6195</td><td style="text-align:center">0.4448</td></tr><tr><td style="text-align:center">4.2405</td><td style="text-align:center">0.447</td><td style="text-align:center">3.6155</td><td style="text-align:center">0.447</td></tr><tr><td style="text-align:center">4.2429</td><td style="text-align:center">0.4492</td><td style="text-align:center">3.6136</td><td style="text-align:center">0.4492</td></tr><tr><td style="text-align:center">4.2454</td><td style="text-align:center">0.4514</td><td style="text-align:center">3.6096</td><td style="text-align:center">0.4514</td></tr><tr><td style="text-align:center">4.2482</td><td style="text-align:center">0.4536</td><td style="text-align:center">3.6046</td><td style="text-align:center">0.4536</td></tr><tr><td style="text-align:center">4.2494</td><td style="text-align:center">0.4558</td><td style="text-align:center">3.6031</td><td style="text-align:center">0.4558</td></tr><tr><td style="text-align:center">4.2535</td><td style="text-align:center">0.458</td><td style="text-align:center">3.5993</td><td style="text-align:center">0.458</td></tr><tr><td style="text-align:center">4.2547</td><td style="text-align:center">0.4602</td><td style="text-align:center">3.5953</td><td style="text-align:center">0.4603</td></tr><tr><td style="text-align:center">4.2587</td><td style="text-align:center">0.4625</td><td style="text-align:center">3.59</td><td style="text-align:center">0.4625</td></tr><tr><td style="text-align:center">4.2618</td><td style="text-align:center">0.4647</td><td style="text-align:center">3.5851</td><td style="text-align:center">0.4647</td></tr><tr><td style="text-align:center">4.2643</td><td style="text-align:center">0.4669</td><td style="text-align:center">3.581</td><td style="text-align:center">0.4669</td></tr><tr><td style="text-align:center">4.2677</td><td style="text-align:center">0.4691</td><td style="text-align:center">3.5761</td><td style="text-align:center">0.4691</td></tr><tr><td style="text-align:center">4.2727</td><td style="text-align:center">0.4713</td><td style="text-align:center">3.5699</td><td style="text-align:center">0.4713</td></tr><tr><td style="text-align:center">4.2742</td><td style="text-align:center">0.4735</td><td style="text-align:center">3.564</td><td style="text-align:center">0.4735</td></tr><tr><td style="text-align:center">4.2783</td><td style="text-align:center">0.4757</td><td style="text-align:center">3.5572</td><td style="text-align:center">0.4757</td></tr><tr><td style="text-align:center">4.2832</td><td style="text-align:center">0.4779</td><td style="text-align:center">3.5491</td><td style="text-align:center">0.478</td></tr><tr><td style="text-align:center">4.2873</td><td style="text-align:center">0.4802</td><td style="text-align:center">3.5407</td><td style="text-align:center">0.4802</td></tr><tr><td style="text-align:center">4.2935</td><td style="text-align:center">0.4824</td><td style="text-align:center">3.5299</td><td style="text-align:center">0.4824</td></tr><tr><td style="text-align:center">4.2959</td><td style="text-align:center">0.4846</td><td style="text-align:center">3.5197</td><td style="text-align:center">0.4846</td></tr><tr><td style="text-align:center">4.3025</td><td style="text-align:center">0.4868</td><td style="text-align:center">3.5063</td><td style="text-align:center">0.4868</td></tr><tr><td style="text-align:center">4.308</td><td style="text-align:center">0.489</td><td style="text-align:center">3.4921</td><td style="text-align:center">0.489</td></tr><tr><td style="text-align:center">4.3142</td><td style="text-align:center">0.4912</td><td style="text-align:center">3.4738</td><td style="text-align:center">0.4912</td></tr><tr><td style="text-align:center">4.3211</td><td style="text-align:center">0.4934</td><td style="text-align:center">3.4493</td><td style="text-align:center">0.4934</td></tr><tr><td style="text-align:center">4.3288</td><td style="text-align:center">0.4956</td><td style="text-align:center">3.4245</td><td style="text-align:center">0.4957</td></tr><tr><td style="text-align:center">4.3359</td><td style="text-align:center">0.4979</td><td style="text-align:center">3.3963</td><td style="text-align:center">0.4979</td></tr><tr><td style="text-align:center">4.3446</td><td style="text-align:center">0.5001</td><td style="text-align:center">3.3634</td><td style="text-align:center">0.5001</td></tr><tr><td style="text-align:center">4.3545</td><td style="text-align:center">0.5023</td><td style="text-align:center">3.3268</td><td style="text-align:center">0.5023</td></tr><tr><td style="text-align:center">4.3645</td><td style="text-align:center">0.5045</td><td style="text-align:center">3.2862</td><td style="text-align:center">0.5045</td></tr><tr><td style="text-align:center">4.3747</td><td style="text-align:center">0.5067</td><td style="text-align:center">3.2447</td><td style="text-align:center">0.5067</td></tr><tr><td style="text-align:center">4.3877</td><td style="text-align:center">0.5089</td><td style="text-align:center">3.1991</td><td style="text-align:center">0.5089</td></tr><tr><td style="text-align:center">4.4001</td><td style="text-align:center">0.5111</td><td style="text-align:center">3.1467</td><td style="text-align:center">0.5111</td></tr><tr><td style="text-align:center">4.4138</td><td style="text-align:center">0.5133</td><td style="text-align:center">3.0924</td><td style="text-align:center">0.5134</td></tr><tr><td style="text-align:center">4.428</td><td style="text-align:center">0.5156</td><td style="text-align:center">3.0264</td><td style="text-align:center">0.5156</td></tr><tr><td style="text-align:center">4.4441</td><td style="text-align:center">0.5178</td><td style="text-align:center">2.9579</td><td style="text-align:center">0.5178</td></tr><tr><td style="text-align:center">4.4606</td><td style="text-align:center">0.52</td><td style="text-align:center">2.8838</td><td style="text-align:center">0.52</td></tr><tr><td style="text-align:center">4.4785</td><td style="text-align:center">0.5222</td><td style="text-align:center">2.8032</td><td style="text-align:center">0.5222</td></tr><tr><td style="text-align:center">4.4981</td><td style="text-align:center">0.5244</td><td style="text-align:center">2.7989</td><td style="text-align:center">0.5224</td></tr><tr><td style="text-align:center">4.4999</td><td style="text-align:center">0.5245</td><td style="text-align:center"></td><td style="text-align:center"></td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vasp学习备忘录（3）——Vasp案例</title>
      <link href="/posts/d95f3c49/"/>
      <url>/posts/d95f3c49/</url>
      
        <content type="html"><![CDATA[<h2 id="案例一：si团簇">案例一：Si团簇</h2><h3 id="1-结构优化">1.结构优化</h3><h4 id="1-1-输入文件">1.1 输入文件</h4><p>优化前<br><img src="/images/POSCAR.jpg" alt="alt text"><br>优化后<br><img src="/images/CONTCAR.jpg" alt="alt text"><br><strong>POSCAR</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Si_cluster</span><br><span class="line">1.0</span><br><span class="line">       20.0000000000         0.0000000000         0.0000000000</span><br><span class="line">        0.0000000000        20.0000000000         0.0000000000</span><br><span class="line">        0.0000000000         0.0000000000        20.0000000000</span><br><span class="line">   Si</span><br><span class="line">   10</span><br><span class="line">Direct</span><br><span class="line">     0.364230007         0.500000000         0.500000000</span><br><span class="line">     0.635769963         0.500000000         0.500000000</span><br><span class="line">     0.500000000         0.364230007         0.500000000</span><br><span class="line">     0.500000000         0.635769963         0.500000000</span><br><span class="line">     0.500000000         0.500000000         0.364230007</span><br><span class="line">     0.500000000         0.500000000         0.635769963</span><br><span class="line">     0.432119995         0.432119995         0.432119995</span><br><span class="line">     0.567880034         0.567880034         0.432119995</span><br><span class="line">     0.567880034         0.432119995         0.567880034</span><br><span class="line">     0.432119995         0.567880034         0.567880034</span><br></pre></td></tr></table></figure><p><strong>INCAR</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#INCAR - VASP 输入控制文件</span><br><span class="line"></span><br><span class="line"># 系统基本信息</span><br><span class="line">SYSTEM system  # 设置计算系统的名称（可自定义）</span><br><span class="line">PREC = Normal  # 计算精度：Normal（标准精度），其他选项有Low/Medium/High/Accurate</span><br><span class="line"></span><br><span class="line"># 电子自旋设置</span><br><span class="line">ISPIN = 1      # 1-非自旋极化计算，2-自旋极化计算</span><br><span class="line"></span><br><span class="line"># 电子步收敛控制</span><br><span class="line">ENCUT = 450    # 平面波截断能（单位：eV），建议使用POTCAR中的ENMAX值</span><br><span class="line">NELM = 200     # 最大电子自洽循环步数</span><br><span class="line">NELMIN = 6     # 最小电子自洽循环步数</span><br><span class="line">NELMDL = -5    # 初始电子步数（负值表示使用前置阻尼）</span><br><span class="line">EDIFF = 1E-6   # 电子步收敛标准（能量变化阈值）</span><br><span class="line"></span><br><span class="line"># 计算算法设置</span><br><span class="line">LREAL = Auto   # 实空间投影方法：Auto自动选择最优方案</span><br><span class="line">ALGO = Normal  # 电子优化算法：Normal标准算法（适用于大多数情况）</span><br><span class="line"></span><br><span class="line"># 离子弛豫设置</span><br><span class="line">EDIFFG = -0.02 # 离子弛豫收敛标准（负值表示力收敛，单位：eV/Å）</span><br><span class="line">NSW = 200      # 最大离子步数</span><br><span class="line">IBRION = 2     # 离子弛豫算法：2-共轭梯度法</span><br><span class="line">ISIF = 3       # 结构优化类型：3-同时优化晶胞形状和原子位置</span><br><span class="line">ISYM = 2       # 对称性处理：2-保持对称性</span><br><span class="line"></span><br><span class="line"># 步长参数</span><br><span class="line">POTIM = 1      # 离子步长（单位：Å），IBRION=2时通常设为1</span><br><span class="line"></span><br><span class="line"># 电子占据设置</span><br><span class="line">ISMEAR = 0     # 展宽方法：0-高斯展宽（绝缘体）</span><br><span class="line">SIGMA = 0.05   # 展宽宽度（单位：eV），对于绝缘体建议0.05-0.1</span><br><span class="line"></span><br><span class="line"># 输出控制</span><br><span class="line">LWAVE = F      # 不输出WAVECAR文件</span><br><span class="line">LCHARG = F     # 不输出CHGCAR文件</span><br><span class="line">NWRITE = 1     # 输出详细级别：1-标准输出</span><br><span class="line"></span><br><span class="line"># 并行计算设置</span><br><span class="line">NPAR = 4       # 能带并行数，建议设置为节点核心数的约数</span><br></pre></td></tr></table></figure><p><strong>KPOINTS</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">K-Mesh</span><br><span class="line">0</span><br><span class="line">M</span><br><span class="line">1 1 1</span><br><span class="line">0.0 0.0 0.0</span><br></pre></td></tr></table></figure><h3 id="2-自洽计算">2.自洽计算</h3><h4 id="2-1-输入文件">2.1 输入文件</h4><p>CONTCAR复制为POSCAR<br>只需修改INCAR</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#INCAR - VASP 输入控制文件</span><br><span class="line"></span><br><span class="line"># 系统基本信息</span><br><span class="line">SYSTEM system  # 计算系统的名称（可自定义，如 &quot;Si_bulk&quot;）</span><br><span class="line">PREC = Normal  # 计算精度：Normal（标准精度），可选 Low/Medium/High/Accurate</span><br><span class="line">               # Normal 是精度和效率的平衡，适合大多数计算</span><br><span class="line"></span><br><span class="line"># 电子自旋设置</span><br><span class="line">ISPIN = 1      # 1=非自旋极化计算（默认），2=自旋极化计算（磁性体系）</span><br><span class="line"></span><br><span class="line"># 电子步收敛控制</span><br><span class="line">ENCUT = 450    # 平面波截断能（单位：eV），需 ≥ POTCAR 中的 ENMAX 值</span><br><span class="line">               # 过高会显著增加计算时间，过低可能影响精度</span><br><span class="line">NELM = 200     # 最大电子自洽循环（SCF）步数</span><br><span class="line">NELMIN = 6     # 最小电子自洽循环步数（即使收敛也至少执行6步）</span><br><span class="line">NELMDL = -5    # 初始非自洽步数（负值表示使用阻尼动力学）</span><br><span class="line">EDIFF = 1E-5   # 电子步收敛标准（能量变化阈值，单位：eV）</span><br><span class="line">               # 默认 1E-4，更严格的值（如 1E-5）适合高精度计算</span><br><span class="line"></span><br><span class="line"># 计算算法设置</span><br><span class="line">LREAL = Auto   # 实空间投影方法：Auto（自动选择最优方案）</span><br><span class="line">               # 对于大体系（&gt;100原子）可提高效率</span><br><span class="line">ALGO = Normal  # 电子优化算法：Normal（标准Davidson算法）</span><br><span class="line">               # 适合大多数体系，其他选项：Fast（快速）、Very_Fast（可能不稳定）</span><br><span class="line"></span><br><span class="line"># 离子弛豫设置（注意：NSW=0 表示仅单点计算，不优化结构）</span><br><span class="line">EDIFFG = -0.02 # 离子步收敛标准（负值表示基于力收敛，单位：eV/Å）</span><br><span class="line">               # 正值表示基于能量变化（单位：eV）</span><br><span class="line">NSW = 0        # 最大离子步数（0=仅单点计算，不优化结构）</span><br><span class="line">IBRION = 2     # 离子弛豫算法：2=共轭梯度法（CG）</span><br><span class="line">               # 仅当 NSW&gt;0 时生效，NSW=0 时忽略</span><br><span class="line">ISIF = 3       # 结构优化类型：3=优化晶胞形状和原子位置</span><br><span class="line">               # 其他选项：2=仅原子位置，4=固定体积优化形状+位置</span><br><span class="line">ISYM = 2       # 对称性处理：2=保持对称性（默认）</span><br><span class="line">               # 0=关闭对称性（可能更耗时但更精确）</span><br><span class="line"></span><br><span class="line"># 步长参数（仅当 NSW&gt;0 时生效）</span><br><span class="line">POTIM = 1      # 离子步长（单位：Å），IBRION=2 时推荐 0.5~1.0</span><br><span class="line"></span><br><span class="line"># 态密度（DOS）相关设置</span><br><span class="line">ISMEAR = 0     # 展宽方法：0=高斯展宽（绝缘体/半导体）</span><br><span class="line">               # -1=费米展宽（金属），1=MPn 方法</span><br><span class="line">SIGMA = 0.05   # 展宽宽度（单位：eV），绝缘体建议 0.05~0.1</span><br><span class="line">               # 金属可能需要更小值（如 0.01~0.02）</span><br><span class="line"></span><br><span class="line"># 输出控制</span><br><span class="line">LWAVE = T      # 输出 WAVECAR 文件（存储波函数）</span><br><span class="line">               # T=保留（后续计算可复用），F=不输出（节省空间）</span><br><span class="line">LCHARG = T     # 输出 CHGCAR 文件（存储电荷密度）</span><br><span class="line">               # 需要计算电荷密度或后续分析时设为 T</span><br><span class="line">NWRITE = 1     # 输出详细级别：1=标准输出，2=更多信息（调试用）</span><br><span class="line"></span><br><span class="line"># 并行计算设置</span><br><span class="line">NPAR = 4       # 能带并行数（建议设置为节点核心数的约数）</span><br><span class="line">               # 例如 4 核/节点可设 NPAR=2 或 4</span><br></pre></td></tr></table></figure><h4 id="2-2-vesta可视化">2.2 Vesta可视化</h4><p>Vesta打开CHGCAR,Utilies&gt;2D Data Display…&gt;slice,可以选择三个原子确定平面。<br><img src="/images/CHGCAR.jpg" alt="alt text"></p><img src="/images/CHGCAR-2-1.jpg" width="250" style="display: block; margin-left: auto; margin-right: auto;"><p>查找费米能级：grep fermi OUTCAR<br>查找总电子数：grep NELECT OUTCAR<br>用vaspkit处理DOSCAR文件得到态密度。</p><h2 id="案例二：co分子优化">案例二：CO分子优化</h2><h3 id="1-扫描结构优化">1.扫描结构优化</h3><h4 id="1-1-输入文件">1.1 输入文件</h4><p><strong>bash脚本</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 生成晶格参数列表</span></span><br><span class="line">list=`<span class="built_in">seq</span> 0.9 0.05 1.5`</span><br><span class="line"><span class="comment"># 循环遍历每个晶格参数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$list</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">cat</span>&gt;POSCAR&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">CO</span></span><br><span class="line"><span class="string">1.0</span></span><br><span class="line"><span class="string">       20.0000000000         0.0000000000         0.0000000000</span></span><br><span class="line"><span class="string">        0.0000000000        20.0000000000         0.0000000000</span></span><br><span class="line"><span class="string">        0.0000000000         0.0000000000        20.0000000000</span></span><br><span class="line"><span class="string">    C    O</span></span><br><span class="line"><span class="string">    1    1</span></span><br><span class="line"><span class="string">Cartesian</span></span><br><span class="line"><span class="string">     0.000000000         0.000000000         0.000000000</span></span><br><span class="line"><span class="string">     0.000000000         0.000000000         $i</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行VASP计算</span></span><br><span class="line">mpirun -np 24 ~/vasp.6.3.2/bin/vasp_std</span><br><span class="line"><span class="comment"># 从OUTCAR中提取总能量</span></span><br><span class="line">E=$(grep <span class="string">&#x27;TOTEN&#x27;</span> OUTCAR | <span class="built_in">tail</span> -1 | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># 将晶格参数和总能量写入summary.dat文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span> <span class="variable">$E</span>&quot;</span> &gt;&gt; summary.dat</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">cat</span> summary.dat</span><br></pre></td></tr></table></figure><p><strong>INCAR</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#INCAR - VASP 输入控制文件</span><br><span class="line"></span><br><span class="line"># =============== 系统基本信息 ===============</span><br><span class="line">SYSTEM system      # 系统名称（可自定义，如 &quot;Si_bulk&quot; 或 &quot;H2O_molecule&quot;）</span><br><span class="line">PREC = Normal      # 计算精度：Normal（标准精度），平衡计算速度和精度</span><br><span class="line">                   # 可选：Low（低）/Medium（中）/High（高）/Accurate（超高，耗时长）</span><br><span class="line">ISPIN = 1          # 自旋设置：1=非自旋极化（默认），2=自旋极化（磁性体系需设为2）</span><br><span class="line"></span><br><span class="line"># ============= 电子弛豫收敛控制 =============</span><br><span class="line">ENCUT = 450        # 平面波截断能（单位：eV），需 ≥ POTCAR 中的 ENMAX 值</span><br><span class="line">                   # 建议值：1.0~1.5×POTCAR中的ENMAX（过高会显著增加计算时间）</span><br><span class="line">NELM = 200         # 最大电子自洽循环（SCF）步数（默认60，复杂体系可增加）</span><br><span class="line">NELMIN = 6         # 最小电子自洽循环步数（即使收敛也至少执行6步）</span><br><span class="line">NELMDL = -5        # 初始非自洽步数（负值表示使用阻尼动力学，帮助收敛）</span><br><span class="line">EDIFF = 1E-5       # 电子步收敛标准（能量变化阈值，单位：eV）</span><br><span class="line">                   # 默认1E-4，高精度计算建议1E-5~1E-6</span><br><span class="line"></span><br><span class="line"># ============== 计算算法设置 ===============</span><br><span class="line">LREAL = F          # 实空间投影方法：F=关闭（使用倒空间投影，精度更高但更耗时）</span><br><span class="line">                   # Auto=自动选择，T=强制开启（大体系可提速）</span><br><span class="line">ALGO = Normal      # 电子优化算法：Normal=标准Davidson算法（稳定）</span><br><span class="line">                   # 可选：Fast（快速）、Very_Fast（可能不稳定）</span><br><span class="line"></span><br><span class="line"># ============== 离子弛豫设置 ===============</span><br><span class="line">EDIFFG = -0.02     # 离子步收敛标准（负值表示基于力收敛，单位：eV/Å）</span><br><span class="line">                   # 正值表示基于能量变化（单位：eV）</span><br><span class="line">                   # 典型值：-0.01（严格）~ -0.05（宽松）</span><br><span class="line">NSW = 60            # 最大离子步数</span><br><span class="line">                   # &gt;0 时需设置 IBRION（优化算法）和 ISIF（优化类型）</span><br><span class="line">ISYM = 2           # 对称性处理：2=保持对称性（默认），0=关闭对称性（可能更精确）</span><br><span class="line">POTIM = 0.5        # 离子步长（单位：Å），默认0.5（NSW=0 时无效）</span><br><span class="line"></span><br><span class="line"># ============== 电子占据设置 ==============</span><br><span class="line">ISMEAR = 0         # 展宽方法：0=高斯展宽（绝缘体/半导体）</span><br><span class="line">                   # -1=费米展宽（金属），1=MPn 方法（金属）</span><br><span class="line">SIGMA = 0.05       # 展宽宽度（单位：eV）</span><br><span class="line">                   # 绝缘体：0.05~0.1；金属：0.01~0.02</span><br><span class="line"></span><br><span class="line"># ============== 输出文件控制 ==============</span><br><span class="line">LWAVE = F          # 是否输出 WAVECAR 文件（存储波函数）</span><br><span class="line">                   # F=不输出（节省空间），T=输出（后续计算可复用）</span><br><span class="line">LCHARG = F         # 是否输出 CHGCAR 文件（存储电荷密度）</span><br><span class="line">                   # F=不输出，T=输出（需电荷密度分析时设为T）</span><br><span class="line">NWRITE = 1         # 输出详细级别：1=标准输出，2=详细输出（调试用）</span><br><span class="line"></span><br><span class="line"># ============== 并行计算设置 ==============</span><br><span class="line">NPAR = 4           # 能带并行数（建议设置为节点核心数的约数）</span><br><span class="line">                   # 例如：4核/节点可设 NPAR=2 或 4</span><br><span class="line">                   # 大体系可尝试 NPAR=sqrt(总核心数)</span><br></pre></td></tr></table></figure><img src="/images/Graph1-1-1.jpg" width="600" style="display: block; margin-left: auto; margin-right: auto;"><p>C-O键长约为1.140埃<br>Exp: 1.129埃</p><h3 id="2-直接结构优化">2.直接结构优化</h3><p>输入文件，除了INCAR其他同扫描结构优化<br><strong>INCAR</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#INCAR - VASP 输入控制文件</span><br><span class="line"></span><br><span class="line"># =============== 系统基本信息 ===============</span><br><span class="line">SYSTEM system      # 系统名称（可自定义，如 &quot;Si_bulk&quot; 或 &quot;H2O_molecule&quot;）</span><br><span class="line">PREC = Normal      # 计算精度：Normal（标准精度），平衡计算速度和精度</span><br><span class="line">                   # 可选：Low（低）/Medium（中）/High（高）/Accurate（超高，耗时长）</span><br><span class="line">ISPIN = 1          # 自旋设置：1=非自旋极化（默认），2=自旋极化（磁性体系需设为2）</span><br><span class="line"></span><br><span class="line"># ============= 电子弛豫收敛控制 =============</span><br><span class="line">ENCUT = 450        # 平面波截断能（单位：eV），需 ≥ POTCAR 中的 ENMAX 值</span><br><span class="line">                   # 建议值：1.0~1.5×POTCAR中的ENMAX（过高会显著增加计算时间）</span><br><span class="line">NELM = 200         # 最大电子自洽循环（SCF）步数（默认60，复杂体系可增加）</span><br><span class="line">NELMIN = 6         # 最小电子自洽循环步数（即使收敛也至少执行6步）</span><br><span class="line">NELMDL = -5        # 初始非自洽步数（负值表示使用阻尼动力学，帮助收敛）</span><br><span class="line">EDIFF = 1E-5       # 电子步收敛标准（能量变化阈值，单位：eV）</span><br><span class="line">                   # 默认1E-4，高精度计算建议1E-5~1E-6</span><br><span class="line"></span><br><span class="line"># ============== 计算算法设置 ===============</span><br><span class="line">LREAL = F          # 实空间投影方法：F=关闭（使用倒空间投影，精度更高但更耗时）</span><br><span class="line">                   # Auto=自动选择，T=强制开启（大体系可提速）</span><br><span class="line">ALGO = Normal      # 电子优化算法：Normal=标准Davidson算法（稳定）</span><br><span class="line">                   # 可选：Fast（快速）、Very_Fast（可能不稳定）</span><br><span class="line"></span><br><span class="line"># ============== 离子弛豫设置 ===============</span><br><span class="line">EDIFFG = -0.02     # 离子步收敛标准（负值表示基于力收敛，单位：eV/Å）</span><br><span class="line">                   # 正值表示基于能量变化（单位：eV）</span><br><span class="line">                   # 典型值：-0.01（严格）~ -0.05（宽松）</span><br><span class="line">NSW = 60            # 最大离子步数</span><br><span class="line">                   # &gt;0 时需设置 IBRION（优化算法）和 ISIF（优化类型）</span><br><span class="line">ISYM = 2           # 对称性处理：2=保持对称性（默认），0=关闭对称性（可能更精确）</span><br><span class="line">POTIM = 0.5        # 离子步长（单位：Å），默认0.5（NSW=0 时无效）</span><br><span class="line"></span><br><span class="line"># ============== 电子占据设置 ==============</span><br><span class="line">ISMEAR = 0         # 展宽方法：0=高斯展宽（绝缘体/半导体）</span><br><span class="line">                   # -1=费米展宽（金属），1=MPn 方法（金属）</span><br><span class="line">SIGMA = 0.05       # 展宽宽度（单位：eV）</span><br><span class="line">                   # 绝缘体：0.05~0.1；金属：0.01~0.02</span><br><span class="line"></span><br><span class="line"># ============== 输出文件控制 ==============</span><br><span class="line">LWAVE = F          # 是否输出 WAVECAR 文件（存储波函数）</span><br><span class="line">                   # F=不输出（节省空间），T=输出（后续计算可复用）</span><br><span class="line">LCHARG = F         # 是否输出 CHGCAR 文件（存储电荷密度）</span><br><span class="line">                   # F=不输出，T=输出（需电荷密度分析时设为T）</span><br><span class="line">NWRITE = 1         # 输出详细级别：1=标准输出，2=详细输出（调试用）</span><br><span class="line"></span><br><span class="line"># ============== 并行计算设置 ==============</span><br><span class="line">NPAR = 4           # 能带并行数（建议设置为节点核心数的约数）</span><br><span class="line">                   # 例如：4核/节点可设 NPAR=2 或 4</span><br><span class="line">                   # 大体系可尝试 NPAR=sqrt(总核心数)</span><br></pre></td></tr></table></figure><p>得到结果文件POTCAT</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CO</span><br><span class="line">   1.000</span><br><span class="line">   20.0000000000000000    0.0000000000000000    0.0000000000000000</span><br><span class="line">    0.0000000000000000   20.0000000000000000    0.0000000000000000</span><br><span class="line">    0.0000000000000000    0.0000000000000000   20.0000000000000000</span><br><span class="line">   C    O </span><br><span class="line">    1    1</span><br><span class="line">Cartesian</span><br><span class="line">    0.0000000000000000    0.0000000000000000    0.1781415744572040     C1</span><br><span class="line">    0.0000000000000000    0.0000000000000000    1.3218584255428540     O1</span><br></pre></td></tr></table></figure><p>CONTCAR文件测量键长Length(C-O)=1.144埃<br>Exp: 1.129埃</p><h2 id="案例三：co分子优化">案例三：CO分子优化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 生成晶格参数列表</span></span><br><span class="line">list=`<span class="built_in">seq</span> 2.41 0.01 2.51`</span><br><span class="line"><span class="comment"># 循环遍历每个晶格参数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$list</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">cat</span>&gt;POSCAR&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">SWNT</span></span><br><span class="line"><span class="string">1.0</span></span><br><span class="line"><span class="string">       21.4829998016         0.0000000000         0.0000000000</span></span><br><span class="line"><span class="string">        0.0000000000        21.4829998016         0.0000000000</span></span><br><span class="line"><span class="string">        0.0000000000         0.0000000000         $i</span></span><br><span class="line"><span class="string">    C</span></span><br><span class="line"><span class="string">   24</span></span><br><span class="line"><span class="string">Direct</span></span><br><span class="line"><span class="string">     0.687160015         0.528779984         0.062820002</span></span><br><span class="line"><span class="string">     0.679319978         0.560850024         0.562820017</span></span><br><span class="line"><span class="string">     0.624870002         0.642350018         0.062820002</span></span><br><span class="line"><span class="string">     0.647689998         0.618510008         0.562820017</span></span><br><span class="line"><span class="string">     0.439150006         0.679319978         0.062820002</span></span><br><span class="line"><span class="string">     0.568650007         0.676479995         0.062820002</span></span><br><span class="line"><span class="string">     0.536960006         0.685720026         0.562820017</span></span><br><span class="line"><span class="string">     0.381489992         0.647689998         0.062820002</span></span><br><span class="line"><span class="string">     0.357650012         0.624870002         0.562820017</span></span><br><span class="line"><span class="string">     0.471219987         0.687160015         0.562820017</span></span><br><span class="line"><span class="string">     0.314280003         0.536960006         0.062820002</span></span><br><span class="line"><span class="string">     0.323520005         0.568650007         0.562820017</span></span><br><span class="line"><span class="string">     0.375129998         0.357650012         0.062820002</span></span><br><span class="line"><span class="string">     0.312840015         0.471219987         0.062820002</span></span><br><span class="line"><span class="string">     0.320679992         0.439150006         0.562820017</span></span><br><span class="line"><span class="string">     0.431349993         0.323520005         0.062820002</span></span><br><span class="line"><span class="string">     0.463039994         0.314280003         0.562820017</span></span><br><span class="line"><span class="string">     0.352310002         0.381489992         0.562820017</span></span><br><span class="line"><span class="string">     0.560850024         0.320679992         0.062820002</span></span><br><span class="line"><span class="string">     0.528779984         0.312840015         0.562820017</span></span><br><span class="line"><span class="string">     0.685720026         0.463039994         0.062820002</span></span><br><span class="line"><span class="string">     0.618510008         0.352310002         0.062820002</span></span><br><span class="line"><span class="string">     0.642350018         0.375129998         0.562820017</span></span><br><span class="line"><span class="string">     0.676479995         0.431349993         0.562820017</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment"># 运行VASP计算</span></span><br><span class="line">mpirun -np 24 ~/vasp.6.3.2/bin/vasp_std</span><br><span class="line"><span class="comment"># 从OUTCAR中提取总能量</span></span><br><span class="line">E=$(grep <span class="string">&#x27;TOTEN&#x27;</span> OUTCAR | <span class="built_in">tail</span> -1 | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># 将晶格参数和总能量写入summary.dat文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span> <span class="variable">$E</span>&quot;</span> &gt;&gt; summary.dat</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">cat</span> summary.dat</span><br></pre></td></tr></table></figure><p>2.41 -217.96840591<br>2.42 -218.12064163<br>2.43 -218.24696821<br>2.44 -218.34710576<br>2.45 -218.42195827<br>2.46 -218.47224402<br>2.47 -218.49839070<br>2.48 -218.50110881<br>2.49 -218.48010355<br>2.50 -218.43723186<br>2.51 -218.37237853<br>2.52 -218.28638937<br>2.53 -218.17992123<br>2.54 -218.05281343<br>2.55 -217.90658055</p><h2 id="案例四：弹性常数计算">案例四：弹性常数计算</h2><h3 id="1-能量-应变法">1.能量-应变法</h3><h4 id="1-1-输入文件">1.1 输入文件</h4><p><strong>INCAR</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># =============== 全局参数设置 ===============</span><br><span class="line">ISTART = 0       # 初始波函数类型：0=从头开始计算（默认）</span><br><span class="line">                 # 1=读取WAVECAR继续计算，2=重启中断的计算</span><br><span class="line">LREAL = F        # 实空间投影：F=关闭（使用倒空间投影，精度最高）</span><br><span class="line">                 # 大体系可设为Auto或T以提高速度（但降低精度）</span><br><span class="line">PREC = A         # 计算精度：A=Accurate（超高精度），推荐用于最终计算</span><br><span class="line">                 # 可选：Normal（标准）, High（高）, Low（低）</span><br><span class="line">LWAVE = F        # 不输出WAVECAR文件（节省存储空间）</span><br><span class="line">                 # 若需后续能带计算，需改为T</span><br><span class="line">LCHARG = F       # 不输出CHGCAR文件（节省存储空间）</span><br><span class="line">                 # 若需电荷密度分析，需改为T</span><br><span class="line">ADDGRID= .TRUE.  # 启用附加网格（提高力和应力计算精度）</span><br><span class="line">                 # 推荐在PREC=Accurate时开启</span><br><span class="line"></span><br><span class="line"># ============= 电子弛豫收敛控制 =============</span><br><span class="line">ISMEAR = 0       # 展宽方法：0=高斯展宽（绝缘体/半导体）</span><br><span class="line">                 # -1=费米展宽（金属），1=MPn方法（金属慎用）</span><br><span class="line">SIGMA = 0.05     # 展宽宽度（单位：eV）</span><br><span class="line">                 # 绝缘体：0.05~0.1；金属：0.01~0.02</span><br><span class="line">NELM = 100       # 最大电子自洽循环步数（默认60）</span><br><span class="line">NELMIN = 4       # 最小电子自洽循环步数（默认2）</span><br><span class="line">EDIFF = 1E-08    # 电子步收敛标准（能量变化阈值，单位：eV）</span><br><span class="line">                 # 极严格标准（1E-8），仅推荐高精度计算使用</span><br><span class="line"></span><br><span class="line"># ============= 离子弛豫优化设置 =============</span><br><span class="line">NELMIN = 6       # 离子步中最小电子步数（覆盖前面的NELMIN=4）</span><br><span class="line">                 # 确保离子步开始时电子充分松弛</span><br><span class="line">NSW = 100        # 最大离子步数（结构优化步数）</span><br><span class="line">IBRION = 2       # 离子弛豫算法：2=共轭梯度法（CG）</span><br><span class="line">                 # 可选：1=准牛顿法（更快但耗内存），3=阻尼分子动力学</span><br><span class="line">ISIF = 2         # 结构优化类型：2=仅优化原子位置（固定晶胞）</span><br><span class="line">                 # 必须设为2（注释说明此计算限制条件）</span><br><span class="line">EDIFFG = -1E-02  # 离子步收敛标准（基于力收敛，单位：eV/Å）</span><br><span class="line">                 # 负值表示力收敛，典型值：-0.01（严格）~ -0.05（宽松）</span><br></pre></td></tr></table></figure><p><strong>POSCAR</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">This file is generated by VASPKIT code</span><br><span class="line"> 1.000000</span><br><span class="line">    5.7430003982000084    0.0000000000000000    0.0000000000000000</span><br><span class="line">    0.0000000000000000    5.7430003982000084    0.0000000000000000</span><br><span class="line">    0.0000000000000000    0.0000000000000000   10.2599999884000201</span><br><span class="line">   Ag   Ga   S </span><br><span class="line">     4     4     8</span><br><span class="line">Direct</span><br><span class="line">    0.0000000000000000    0.0000000000000000    0.0000000000000000     Ag1</span><br><span class="line">    0.0000000000000000    0.5000000000000000    0.2500000000000000     Ag2</span><br><span class="line">    0.5000000000000000    0.5000000000000000    0.5000000000000000     Ag3</span><br><span class="line">    0.5000000000000000    0.0000000000000000    0.7500000000000000     Ag4</span><br><span class="line">    0.5000000000000000    0.5000000000000000    0.0000000000000000     Ga1</span><br><span class="line">    0.5000000000000000    0.0000000000000000    0.2500000000000000     Ga2</span><br><span class="line">    0.0000000000000000    0.0000000000000000    0.5000000000000000     Ga3</span><br><span class="line">    0.0000000000000000    0.5000000000000000    0.7500000000000000     Ga4</span><br><span class="line">    0.2799999860000001    0.2500000000000000    0.1250000000000000      S1</span><br><span class="line">    0.7200000139999999    0.7500000000000000    0.1250000000000000      S2</span><br><span class="line">    0.7500000000000000    0.2200000139999999    0.3750000000000000      S3</span><br><span class="line">    0.2500000000000000    0.7799999860000001    0.3750000000000000      S4</span><br><span class="line">    0.7799999860000001    0.7500000000000000    0.6250000000000000      S5</span><br><span class="line">    0.2200000140000000    0.2500000000000000    0.6250000000000000      S6</span><br><span class="line">    0.2500000000000000    0.7200000139999999    0.8750000000000000      S7</span><br><span class="line">    0.7500000000000000    0.2799999860000000    0.8750000000000000      S8</span><br></pre></td></tr></table></figure><p><strong>KPOINTS</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">K-Spacing Value to Generate K-Mesh: 0.040</span><br><span class="line">0</span><br><span class="line">Monkhorst-Pack</span><br><span class="line">   5   5   5</span><br><span class="line">0.0  0.0  0.0</span><br></pre></td></tr></table></figure><h4 id="1-2-vaspkit批量生成输入文件">1.2 vaspkit批量生成输入文件</h4><p>vaspkit 201功能输入文件<br><strong><a href="http://VPKIT.in">VPKIT.in</a></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1                                               # 1 for pre-processing; 2 for post-processing</span><br><span class="line">3D                                              # 2D for two-dimentional, 3D for bulk</span><br><span class="line">7                                               # number of strain case</span><br><span class="line">-0.015 -0.010 -0.005 0.000 0.005 0.010 0.015    # Strain range</span><br></pre></td></tr></table></figure><h4 id="1-3-批量运行">1.3 批量运行</h4><p>批量运行脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">cals_path=`<span class="built_in">pwd</span>`</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">ls</span> -F | grep /$`</span><br><span class="line"><span class="keyword">do</span> <span class="built_in">cd</span> <span class="variable">$&#123;cals_path&#125;</span>/<span class="variable">$i</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> strain_*</span><br><span class="line"><span class="keyword">do</span> <span class="built_in">cd</span> <span class="variable">$&#123;cals_path&#125;</span>/$i<span class="variable">$j</span></span><br><span class="line">mpirun -np 24 vasp_std</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$OLDPWD</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="1-4-后处理">1.4 后处理</h4><ul><li>VPKIT.in文件1改为2，再次运行201功能；</li><li>将计算获得的ELASTIC_TENSOR文件复制为ELASTIC_TENSOR.in(如果是二维体系则复制为ELASTIC_TENSOR_2D.in)，然后运行VASPKIT 204命令</li><li>选择切隔二维晶面的密勒指数(hkl)</li><li>可以自由选择绘制力学性质相关的图片(这里选择剪切模量)<br><img src="/images/Young_Modulus-1.jpg" width="250" style="display: block; margin-left: auto; margin-right: auto;"></li></ul><h3 id="2-应力-应变法">2.应力-应变法</h3><p>基本同能量应变法，选择200功能生成输入文件，200功能处理结果文件，同样修改1为2.</p><h3 id="3-直接计算法">3.直接计算法</h3><p>INCAR输入文件<br>vaspkit-&gt;101-&gt;DC<br>结果处理<br>vaspkit-&gt;203<br>可视化<br>vaspkit-&gt;204<br><a href="https://progs.coudert.name/elate">ELASTIC_TENSOR的6×6×6矩阵-&gt;可视化网站</a></p><h2 id="案例五：cohp计算-晶体轨道哈密顿布局函数">案例五：COHP计算（晶体轨道哈密顿布局函数）</h2><h4 id="1-1-输入文件">1.1 输入文件</h4><p>COHP是晶体轨道哈密顿布局函数（Crystal Orbital Hamilton Populations），是用哈密顿矩阵加权的DOS，可以用于划分能量空间内哪些是成键、非键合和反键的贡献。<br>它的定义如下：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>f</mi><mi>j</mi></msub><msub><mi>ε</mi><mi>j</mi></msub><mi>δ</mi><mo stretchy="false">(</mo><msub><mi>ε</mi><mi>j</mi></msub><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>f</mi><mi>j</mi></msub><munder><mo>∑</mo><mrow><mi>R</mi><mi>L</mi></mrow></munder><munder><mo>∑</mo><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></munder><msup><mi>u</mi><mo lspace="0em" rspace="0em">∗</mo></msup><msub><mrow></mrow><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><msub><mi>H</mi><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><msub><mi>u</mi><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mi>δ</mi><mo stretchy="false">(</mo><msub><mi>ε</mi><mi>j</mi></msub><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>R</mi><mi>L</mi></mrow></munder><munder><mo>∑</mo><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></munder><msub><mi>H</mi><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><munder><munder><mrow><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>f</mi><mi>j</mi></msub><msup><mi>u</mi><mo lspace="0em" rspace="0em">∗</mo></msup><msub><mrow></mrow><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><msub><mi>u</mi><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mi>δ</mi><mo stretchy="false">(</mo><msub><mi>ε</mi><mi>j</mi></msub><mo>−</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">⏟</mo></munder><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">O</mi><mi mathvariant="normal">S</mi><mtext> </mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi></mrow></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>R</mi><mi>L</mi></mrow></munder><munder><mo>∑</mo><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></munder><msub><mi>H</mi><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><msub><mi>N</mi><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mo stretchy="false">(</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>R</mi><mi>L</mi></mrow></munder><munder><mo>∑</mo><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></munder><msub><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">O</mi><mi mathvariant="normal">H</mi><mi mathvariant="normal">P</mi></mrow><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mo stretchy="false">(</mo><mi>ε</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\sum_{j}f_{j}\varepsilon_{j}\delta(\varepsilon_{j}-\varepsilon)&amp; =\sum_{j}f_{j}\sum_{RL}\sum_{R^{\prime}L^{\prime}}u^{*}{}_{RL,j}H_{RL,R^{\prime}L^{\prime}}u_{R^{\prime}L^{\prime},j^{\prime}}\delta(\varepsilon_{j}-\varepsilon) \\&amp;=\sum_{RL} \sum_{R^{\prime}L^{\prime}}H_{RL,R^{\prime}L^{\prime}}\underbrace{\sum_{j}f_{j}u^{*}{}_{RL,j}u_{R^{\prime}L^{\prime},j^{\prime}}\delta(\varepsilon_{j}-\varepsilon)}_{\mathrm{DOS~matrix}} \\&amp;=\sum_{RL}\sum_{R^{\prime}L^{\prime}}H_{RL,R^{\prime}L^{\prime}}N_{RL,R^{\prime}L^{\prime}}(\varepsilon) \\&amp;=\sum_{RL}\sum_{R^{\prime}L^{\prime}}\mathrm{COHP}_{RL,R^{\prime}L^{\prime}}(\varepsilon)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:12.142577em;vertical-align:-5.8212885em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.3212885em;"><span style="top:-8.3212885em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">ε</span><span class="mclose">)</span></span></span><span style="top:-5.557506500000001em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"></span></span><span style="top:-1.4673934999999998em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"></span></span><span style="top:1.1769474999999991em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.8212885em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.3212885em;"><span style="top:-8.3212885em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">ε</span><span class="mclose">)</span></span></span><span style="top:-5.557506500000001em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-0.30989699999999987em;"><span class="pstrut" style="height:3.050005em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">O</span><span class="mord mathrm mtight">S</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">a</span><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">r</span><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">x</span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span class="svg-align" style="top:-0.9882279999999999em;"><span class="pstrut" style="height:3.050005em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class="brace-center" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class="brace-right" style="height:0.548em;"><svg width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">ε</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.061777em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.740108em;"><span></span></span></span></span></span></span></span><span style="top:-1.4673934999999998em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">ε</span><span class="mclose">)</span></span></span><span style="top:1.1769474999999991em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">C</span><span class="mord mathrm">O</span><span class="mord mathrm">H</span><span class="mord mathrm">P</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">ε</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.8212885em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中R表示原子位置，L表示为原子轨道，j是能带，f<sub>j</sub>指的是占据数。<br>它的主要思想是将波函数拆分为原子轨道的线性叠加</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>ψ</mi><mi>j</mi></msub><mo stretchy="false">⟩</mo><mo>=</mo><munder><mo>∑</mo><mrow><mi>R</mi><mi>L</mi></mrow></munder><mi mathvariant="normal">∣</mi><msub><mi>χ</mi><mrow><mi>R</mi><mi>L</mi></mrow></msub><mo stretchy="false">⟩</mo><msub><mi>u</mi><mrow><mi>R</mi><mi>L</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">|\psi_{j}\rangle=\sum_{RL}|\chi_{RL}\rangle u_{RLj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.344341em;vertical-align:-1.294336em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>哈密顿矩阵的形式为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>R</mi><mi>L</mi><mo separator="true">,</mo><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mo>≡</mo><mo stretchy="false">⟨</mo><msub><mi>χ</mi><mrow><mi>R</mi><mi>L</mi></mrow></msub><mi mathvariant="normal">∣</mi><mover accent="true"><mi>H</mi><mo>^</mo></mover><mi mathvariant="normal">∣</mi><msub><mi>χ</mi><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mo stretchy="false">⟩</mo><mo>=</mo><mo stretchy="false">⟨</mo><msub><mi>χ</mi><mrow><mi>R</mi><mi>L</mi></mrow></msub><mi mathvariant="normal">∣</mi><mo>−</mo><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mo>+</mo><mi>v</mi><mo stretchy="false">(</mo><mover accent="true"><mi>r</mi><mo>~</mo></mover><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><msub><mi>χ</mi><mrow><msup><mi>R</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><msup><mi>L</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">H_{RL,R^{\prime}L^{\prime}}\equiv\langle\chi_{RL}|\hat{H}|\chi_{R^{\prime}L^{\prime}}\rangle=\langle\chi_{RL}|-\nabla^{2}+v(\tilde{r})|\chi_{R^{\prime}L^{\prime}}\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6678599999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span></span></p><p>由此得到COHP矩阵的非对角元就可以用于表示原子对之间的对于成键、非键合和反键的贡献。</p><p>（1）准备lobsterin</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COHPstartEnergy -22</span><br><span class="line">COHPendEnergy 18</span><br><span class="line">basisSet Bunge</span><br><span class="line">includeorbitals sp</span><br><span class="line">cohpbetween atom 1 and atom 2</span><br></pre></td></tr></table></figure><p><img src="/images/image.png" alt="alt text"></p><p>（2）运行LOBSTER<br>调用之前压缩包内的可执行文件lobster-5.0.0，例如:<br><code>$ ~/software/lobster/lobster-5.0.0/lobster-5.0.0 &lt; lobsterin</code><br>等待程序运行结束，即可查看结果于COHPCAR.lobster<br>COHPStartEnergy/COHPEndEnergy: 设定的能量窗口，单位是eV。值得注意的是这里是把费<br>米面归零后的值。<br>basisFunctions： 为每种元素设定basis functions，填写的时候最好按照赝势文件里价电子的轨<br>道来写<br>cohpBetween： 这个参数可以重复，用于指定原子对<br>更多参数可以参考lobster-5.0.0.tar.gz压缩包内的Lobster手册Lobster_Users_Guide_5.0.0.pd</p><p>在产生的文件COHPCAR.lobster中第一列是能量，第二列是平均所有原子对的COHP值，第三<br>列是平均所有原子对的ICOHP值，第四列是第1个原子对的COHP值，第五列是第1个原子对的<br>ICOHP值，如下图。</p><p><a href="https://blog.sciencenet.cn/home.php?mod=space&amp;uid=90975&amp;do=blog&amp;id=1137555">https://blog.sciencenet.cn/home.php?mod=space&amp;uid=90975&amp;do=blog&amp;id=1137555</a></p><p><img src="/images/Graph1.jpg" width="300" style="display: block; margin-left: auto; margin-right: auto;"><figcaption style="text-align: center;"></figcaption></p>]]></content>
      
      
      
        <tags>
            
            <tag> DFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vasp学习备忘录（2）——三种KPOINTS</title>
      <link href="/posts/e38cb4cc/"/>
      <url>/posts/e38cb4cc/</url>
      
        <content type="html"><![CDATA[<p>三种自动设置K点的方式：<strong>Auto，Gamma，Monkhorst</strong>。</p><h2 id="auto-格式的kpoints文件">Auto 格式的KPOINTS文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Automatic mesh         #注释行</span><br><span class="line">0                      #表示要自动产生k点了</span><br><span class="line">Auto                   #自动产生k的方法选为Auto，只看首字母</span><br><span class="line">I                      #参数I，倒易空间中的网格间距为I^(-1)。</span><br></pre></td></tr></table></figure><ol><li>Auto方式实际上指定了倒易空间中K-mesh的密度，因此在计算同一个体系的单胞、超胞时，可以使用同样的I值（默认单位是Å）。通常l取10（对于大gap的绝缘体），~100（d-金属）。</li><li>按照（1）的说法，因为近似有k|a| = l，即某个方向上的K点个数k，乘以这个方向的晶胞常数|a|，得到一个大约50左右的数比较合适。</li><li>注意：由于k = max(1, l|b|+0.5)，所以对slab模型可能会在z方向上k &gt;1（虽然|b|=1/|c|确实比较小），所以slab模型用Auto可能会不适合。</li></ol><h2 id="g或m格式的kpoints文件">G或M格式的KPOINTS文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Automatic mesh         #注释行</span><br><span class="line">0                      #表示要自动产生k点了</span><br><span class="line">Gamma                  #自动产生k的方法选为G，还可选Monkhorst。只看首字母。</span><br><span class="line">k1 k2 k3               #三个方向分别多少个k点。</span><br><span class="line">0  0  0                #K网格的平移</span><br></pre></td></tr></table></figure><ol><li><p>关于平移：Monkhorst with (0.5 0.5 0.5)的平移，就等价于Gamma with (0 0 0)，Gamma with (0.5 0.5 0.5)的平移，就等价于Monkhorst with (0 0 0)，所以一般网格平移都写为0 0 0。</p></li><li><p>三种模式实际上产生的都是Monkhorst-Pack grids，其中Auto和Gamma的K-mesh中包含Γ点，即是Gamma centered，而Monkhorst不一定。</p></li><li><p>对于奇数K点，Gamma和Monkhorst-Pack效果完全一样，都包含Γ点，而对偶数情况，M和G才会不一样。<img src="/images/image-20250715102153890.png" alt="image-20250715102153890"></p></li><li><p>下面以一维的K-mesh为例，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">k=5，       G和M一样：        0, ±1/5, ±2/5。</span><br><span class="line">k=6，       G：              0, ±1/6, ±2/6, 3/6 （注意没有-3/6，因为它与3/6重合）</span><br><span class="line">            M：              ±1/12, ±3/12, ±5/12</span><br><span class="line">k=7，       G和M一样：        0, ±1/7, ±2/7，±3/7，</span><br></pre></td></tr></table></figure><p>可以看出，如果体系是关于中心对称的，则<br>(1)对与G来说，k为偶数时，K点的分布是不对称的，导致其不可约点的个数较多，因此与k+1（奇数）的结果比较接近。（k=6和k=7时都有4个不可约K点）。<br>(2) 而对M来说，k为偶数时，K点分布对称，导致不可约的K点数目少，因此与k-1（奇数）的时候接近（k=6和k=5时都有3个不可约的K点）。<br>这就是为什么一般会说：对于G用偶数的k，对于M用奇数的k（而此时M与G一致)。若体系没有对称性，则使用何种K-mesh与奇偶无关。一般考虑包括Γ点的K-mesh，即G-mesh。</p></li></ol><p>结论：使用Gamma形式的K-mesh，其中k点数目少的时候k设为偶数为佳。</p>]]></content>
      
      
      
        <tags>
            
            <tag> DFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vasp学习备忘录（1）——输入参数</title>
      <link href="/posts/ef0a8c6d/"/>
      <url>/posts/ef0a8c6d/</url>
      
        <content type="html"><![CDATA[<h2 id="incar-主要参数设置">INCAR 主要参数设置</h2><h3 id="初始化">初始化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 1. 系统名称（仅标识用途，不影响计算）</span><br><span class="line">SYSTEM = name  </span><br><span class="line"></span><br><span class="line"># 2. 输出详细程度 (0-4)</span><br><span class="line">#   | 0: 最小输出 | 1: 基础输出（默认） | </span><br><span class="line">#   | 2: 详细输出（推荐） | 3-4: 调试级输出 |</span><br><span class="line">NWRITE = 2     </span><br><span class="line"></span><br><span class="line"># 3. 是否读取波函数文件（WAVECAR）</span><br><span class="line">#   | 0: 从头计算（不读WAVECAR） | </span><br><span class="line">#   | 1: 续算（读WAVECAR，适合结构优化/ENCUT测试） |</span><br><span class="line">#   | 2: 续算且保持基矢不变（特殊用途） |</span><br><span class="line">ISTART = 0     </span><br><span class="line"></span><br><span class="line"># 4. 初始电荷密度构建方式</span><br><span class="line">#   | 0: 从波函数生成（需ISTART=1） | </span><br><span class="line">#   | 1: 从CHGCAR插值原子密度 | </span><br><span class="line">#   | 2: 直接构造原子密度（默认，ISTART=0时） |</span><br><span class="line">#   | 11: 非自洽计算（读取CHGCAR做能带/态密度） |</span><br><span class="line">#   | 12: 非自洽原子密度计算 |</span><br><span class="line">ICHARG = 2    </span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               常见组合场景</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 全新计算（默认）：</span><br><span class="line">#   ISTART=0, ICHARG=2</span><br><span class="line">#</span><br><span class="line"># 2. 续算（优化/静态计算）：</span><br><span class="line">#   ISTART=1, ICHARG=1（读WAVECAR和CHGCAR）</span><br><span class="line">#</span><br><span class="line"># 3. 非自洽能带计算：</span><br><span class="line">#   ISTART=1, ICHARG=11（读CHGCAR）</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="电子自洽收敛">电子自洽收敛</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># 1. 初始波函数设置（仅当 ISTART=0 时生效）</span><br><span class="line">#   | 0: 使用 &quot;jellium&quot; 波函数（均匀电子气近似） |</span><br><span class="line">#   | 1: 使用随机波函数（默认，推荐） |</span><br><span class="line">INIWAV = 1</span><br><span class="line"></span><br><span class="line"># 2. 电子自洽迭代控制</span><br><span class="line">#   - NELM: 最大电子迭代步数（默认 60）</span><br><span class="line">#     * 若超过 40 步未收敛，需调整 IALGO/LDIAG 或混合参数</span><br><span class="line">NELM = 60</span><br><span class="line"></span><br><span class="line">#   - NELMIN: 最小电子迭代步数</span><br><span class="line">#     * 默认 2，分子动力学（MD）或离子弛豫推荐 4-8</span><br><span class="line">NELMIN = 2</span><br><span class="line"></span><br><span class="line">#   - NELMDL: 初始非自洽迭代步数（预热步）</span><br><span class="line">#     * ISTART=0 + INIWAV=1 + IALGO=48/50 时默认 -12</span><br><span class="line">#     * 存在 WAVECAR 时强制为 0</span><br><span class="line">#     * 其他情况为 0（无预热）</span><br><span class="line">NELMDL = -12</span><br><span class="line"></span><br><span class="line"># 3. 电子收敛标准</span><br><span class="line">#   - EDIFF: 总能收敛阈值（默认 1E-4，单位 eV）</span><br><span class="line">#     * 严格计算可用 1E-5，快速测试可用 1E-3</span><br><span class="line">EDIFF = 1E-4</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键参数组合建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 标准自洽计算（SCF）：</span><br><span class="line">#   INIWAV=1, NELM=60, NELMIN=2, EDIFF=1E-4</span><br><span class="line">#</span><br><span class="line"># 2. 分子动力学（MD）或弛豫：</span><br><span class="line">#   NELMIN=6（减少离子步假收敛）</span><br><span class="line">#</span><br><span class="line"># 3. 难收敛体系：</span><br><span class="line">#   NELM=100 + IALGO=48 + 调整混合参数（AMIX/BMIX）</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="原子弛豫">原子弛豫</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"># 1. 结构优化收敛标准</span><br><span class="line">#   - EDIFFG: 原子弛豫收敛阈值（默认 EDIFF*10）</span><br><span class="line">#     * &gt;0: 基于总能变化（|E_&#123;n&#125;-E_&#123;n-1&#125;| &lt; EDIFFG）</span><br><span class="line">#     * &lt;0: 基于最大力（|F_&#123;max&#125;| &lt; |EDIFFG|，推荐 -0.02 到 -0.05）</span><br><span class="line">EDIFFG = -0.05  # 单位：eV/Å</span><br><span class="line"></span><br><span class="line"># 2. 结构优化/分子动力学步数控制</span><br><span class="line">#   - NSW: 最大离子步数（默认 0）</span><br><span class="line">#     * 结构优化：通常 20-200 步</span><br><span class="line">#     * 分子动力学：步数=模拟时间（fs）/POTIM</span><br><span class="line">NSW = 50</span><br><span class="line"></span><br><span class="line"># 3. 输出与采样控制</span><br><span class="line">#   - NBLOCK: 每 NBLOCK 步输出一次 XDATCAR 和辅助数据（默认 1）</span><br><span class="line">#   - KBLOCK: 每 KBLOCK*NBLOCK 步输出对关联函数/DOS（默认 NSW）</span><br><span class="line">NBLOCK = 10</span><br><span class="line">KBLOCK = 5</span><br><span class="line"></span><br><span class="line"># 4. 原子移动算法（IBRION）</span><br><span class="line">#   | -1: 固定原子位置（静态计算）       |</span><br><span class="line">#   |  0: 分子动力学（MD，需设 POTIM）  |</span><br><span class="line">#   |  1: 准牛顿法（快速收敛，推荐）     |</span><br><span class="line">#   |  2: 共轭梯度法（精度高）          |</span><br><span class="line">#   |  3: 最速下降法（稳定性好）        |</span><br><span class="line">#   |  5: 频率计算（需设 NFREE）        |</span><br><span class="line">IBRION = 1</span><br><span class="line"></span><br><span class="line"># 5. 分子动力学与频率计算参数</span><br><span class="line">#   - POTIM: 时间步长（IBRION=0，单位 fs）或位移步长（IBRION=1/2/3）</span><br><span class="line">#     * MD: 通常 0.5-2.0 fs（依赖体系）</span><br><span class="line">#     * 结构优化: 默认 0.5（可调大到 1.0 加速收敛）</span><br><span class="line">POTIM = 0.5</span><br><span class="line"></span><br><span class="line">#   - NFREE: 频率计算自由度（IBRION=5 时需设）</span><br><span class="line">#     * 2: 中心差分法（推荐）</span><br><span class="line">#     * 4: 高阶差分法（更耗时）</span><br><span class="line">NFREE = 2</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键参数组合建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 结构优化（快速收敛）：</span><br><span class="line">#   IBRION=1, POTIM=0.5, EDIFFG=-0.02, NSW=100</span><br><span class="line">#</span><br><span class="line"># 2. 分子动力学（NVT 系综）：</span><br><span class="line">#   IBRION=0, POTIM=1.0, SMASS=1, NSW=1000</span><br><span class="line">#</span><br><span class="line"># 3. 频率计算：</span><br><span class="line">#   IBRION=5, NFREE=2, NSW=1</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="结构优化">结构优化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># 1. 结构优化模式与应力计算（ISIF）</span><br><span class="line">#   | 值 | 优化对象                     | 计算应力 | 适用场景                 |</span><br><span class="line">#   |----|------------------------------|----------|--------------------------|</span><br><span class="line">#   | 0  | 仅原子位置                   | 否       | 固定晶胞的原子弛豫       |</span><br><span class="line">#   | 1  | 仅原子位置                   | 是       | 固定晶胞的应力计算       |</span><br><span class="line">#   | 2  | 原子位置 + 晶胞形状/体积     | 是       | 全弛豫（默认，推荐）      |</span><br><span class="line">#   | 3  | 仅晶胞形状/体积（原子固定）  | 是       | 纯晶胞优化               |</span><br><span class="line">#   | 4  | 原子位置 + 晶胞形状（固定体积）| 是     | 恒定体积优化（如NPT-MD） |</span><br><span class="line">#   | 5  | 仅晶胞形状（固定体积+原子）  | 是       | 特殊约束优化             |</span><br><span class="line">#   | 6  | 仅晶胞体积（形状+原子固定）  | 是       | 体积扫描（E-V曲线）      |</span><br><span class="line">#   | 7  | 原子位置 + 晶胞体积（固定形状）| 是     | 各向同性膨胀/压缩        |</span><br><span class="line">ISIF = 2       # 默认值（全弛豫）</span><br><span class="line"></span><br><span class="line"># 2. 外部应力设置（PSTRESS）</span><br><span class="line">#   - 单位：kBar（1 kBar = 0.1 GPa）</span><br><span class="line">#   - 施加各向同性静水应力（如 10 kBar 压力）：</span><br><span class="line">PSTRESS = 10   # 正值为压缩，负值为拉伸</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键参数组合建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 全结构优化（晶胞+原子）：</span><br><span class="line">#   ISIF=2, IBRION=1/2, EDIFFG=-0.02</span><br><span class="line">#</span><br><span class="line"># 2. 固定晶胞优化原子：</span><br><span class="line">#   ISIF=0, IBRION=1</span><br><span class="line">#</span><br><span class="line"># 3. 恒定压力模拟（如 1 GPa）：</span><br><span class="line">#   ISIF=3, PSTRESS=10, IBRION=0（MD）</span><br><span class="line">#</span><br><span class="line"># 4. 体积扫描（E-V曲线）：</span><br><span class="line">#   ISIF=6, NSW=1（静态计算）</span><br><span class="line"># ================================================</span><br><span class="line"></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center"><strong>ISIF</strong></th><th style="text-align:center"><strong>计算离子所受的力</strong></th><th style="text-align:center"><strong>计算原胞的stress tensor</strong></th><th style="text-align:center"><strong>离子位置驰豫</strong></th><th style="text-align:center"><strong>改变原胞的形状</strong></th><th style="text-align:center"><strong>改变原胞的体积</strong></th></tr></thead><tbody><tr><td style="text-align:center"><strong>0</strong></td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">否</td></tr><tr><td style="text-align:center"><strong>1</strong></td><td style="text-align:center">是</td><td style="text-align:center">trace only</td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">否</td></tr><tr><td style="text-align:center"><strong>2</strong></td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">否</td></tr><tr><td style="text-align:center"><strong>3</strong></td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">是</td></tr><tr><td style="text-align:center"><strong>4</strong></td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">否</td></tr><tr><td style="text-align:center"><strong>5</strong></td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">是</td><td style="text-align:center">否</td></tr><tr><td style="text-align:center"><strong>6</strong></td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">是</td><td style="text-align:center">是</td></tr><tr><td style="text-align:center"><strong>7</strong></td><td style="text-align:center">是</td><td style="text-align:center">是</td><td style="text-align:center">否</td><td style="text-align:center">否</td><td style="text-align:center">是</td></tr></tbody></table><h3 id="对称性和温度">对称性和温度</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># 1. 对称性设置</span><br><span class="line">#   - ISYM: 对称性处理（影响计算效率）</span><br><span class="line">#     | 0: 关闭对称性（强制原胞计算，推荐测试能带/缺陷） |</span><br><span class="line">#     | 1: 仅用点群对称性（超软赝势默认）              |</span><br><span class="line">#     | 2: 用点群+平移对称性（PAW势默认，高效但可能漏解）|</span><br><span class="line">ISYM = 0       # 关闭对称性（确保K点路径连续）</span><br><span class="line"></span><br><span class="line">#   - SYMPREC: 坐标对称性判断精度（默认 1E-5）</span><br><span class="line">#     * 若对称性误判（如缺陷体系），可调大到 1E-4</span><br><span class="line">SYMPREC = 1E-5</span><br><span class="line"></span><br><span class="line"># 2. 力修正（Harris泛函修正）</span><br><span class="line">#   - LCORR: 对力和应力进行Harris修正（默认 .TRUE.）</span><br><span class="line">#     * 若力收敛异常，可设为 .FALSE.</span><br><span class="line">LCORR = .TRUE.</span><br><span class="line"></span><br><span class="line"># 3. 分子动力学温度控制</span><br><span class="line">#   - TEBEG: 初始温度（单位 K，默认 0）</span><br><span class="line">#     * 若POSCAR无速度，按Maxwell-Boltzmann分布生成</span><br><span class="line">TEBEG = 300    # 例如 300 K</span><br><span class="line"></span><br><span class="line">#   - TEEND: 目标温度（默认 = TEBEG，恒温模拟）</span><br><span class="line">#     * 用于退火模拟（如 300 K → 1000 K）</span><br><span class="line">TEEND = 300    # 恒温模式</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键参数组合建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 能带/缺陷计算（需关闭对称性）：</span><br><span class="line">#   ISYM=0, SYMPREC=1E-4</span><br><span class="line">#</span><br><span class="line"># 2. 分子动力学（NVT系综）：</span><br><span class="line">#   IBRION=0, TEBEG=300, TEEND=300, SMASS=1</span><br><span class="line">#</span><br><span class="line"># 3. 退火模拟（升温过程）：</span><br><span class="line">#   IBRION=0, TEBEG=300, TEEND=1000, SMASS=-1</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="系综">系综</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 1. 分子动力学系综控制（SMASS）</span><br><span class="line">#   | 值   | 说明                                                                 |</span><br><span class="line">#   |------|----------------------------------------------------------------------|</span><br><span class="line">#   | -3   | 微正则系综（NVE，总能量守恒，默认）                                 |</span><br><span class="line">#   | -2   | 固定初始速度（用于测试总能随位置变化）                              |</span><br><span class="line">#   | -1   | 每 NBLOCK 步缩放速度（手动控温）                                    |</span><br><span class="line">#   | ≥0   | 正则系综（NVT，Nose-Hoover 控温，推荐 SMASS=1）                     |</span><br><span class="line">#   * 温度公式（SMASS≥0时）：TEMP = TEBEG + (TEEND-TEBEG)*NSTEP/NSW</span><br><span class="line">SMASS = -3      # 默认微正则系综（NVE）</span><br><span class="line"></span><br><span class="line"># 2. 对关联函数设置</span><br><span class="line">#   - NPACO: 对关联函数输出点数（默认 256）</span><br><span class="line">#   - APACO: 对关联函数计算范围（Å，默认 16）</span><br><span class="line">NPACO = 256</span><br><span class="line">APACO = 16.0</span><br><span class="line"></span><br><span class="line"># 3. 原子属性（必须在 POTCAR 中定义，此处仅为说明）</span><br><span class="line">#   - POMASS: 原子质量（单位 amu，取自 POTCAR）</span><br><span class="line">#     示例：POMASS = 12.01  # 碳原子质量</span><br><span class="line">#   - ZVAL: 价电子数（取自 POTCAR）</span><br><span class="line">#     示例：ZVAL = 4        # 碳的价电子数</span><br><span class="line">#   * 注意：这些值由赝势文件决定，无需在 INCAR 中设置！</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键参数组合建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. NVT 系综（恒温分子动力学）：</span><br><span class="line">#   SMASS=1, TEBEG=300, TEEND=300, IBRION=0</span><br><span class="line">#</span><br><span class="line"># 2. NVE 系综（能量守恒模拟）：</span><br><span class="line">#   SMASS=-3, IBRION=0</span><br><span class="line">#</span><br><span class="line"># 3. 对关联函数分析（如液态体系）：</span><br><span class="line">#   NPACO=512, APACO=20.0（提高分辨率）</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="自旋极化和电子的优化算法">自旋极化和电子的优化算法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># 1. 自旋极化计算设置</span><br><span class="line">#   - ISPIN: 是否开启自旋极化</span><br><span class="line">#     | 1: 非自旋极化计算（默认） |</span><br><span class="line">#     | 2: 自旋极化计算（磁性体系） |</span><br><span class="line">ISPIN = 2       # 开启自旋极化（计算磁性）</span><br><span class="line"></span><br><span class="line">#   - MAGMOM: 初始磁矩设置（格式：原子数*磁矩，如 2*0.6 3*1.0）</span><br><span class="line">#     * 默认值：Nion*1.0（Nion为原子数）</span><br><span class="line">#     * 反铁磁初始化示例：MAGMOM = 2*1.0 -2*1.0  # 前两个原子↑，后两个↓</span><br><span class="line">MAGMOM = 4*1.0  # 4个原子初始磁矩1.0 μB</span><br><span class="line"></span><br><span class="line"># 2. 电子优化算法</span><br><span class="line">#   - ALGO: 算法预设模式（覆盖IALGO）</span><br><span class="line">#     | Fast:     混合算法（IALGO=38+48，默认） |</span><br><span class="line">#     | Normal:   仅Blocked Davidson（IALGO=38）|</span><br><span class="line">#     | Very_Fast:仅RMM-DIIS（IALGO=48，推荐金属体系） |</span><br><span class="line">ALGO = Fast     # 平衡速度与稳定性</span><br><span class="line"></span><br><span class="line">#   - IALGO: 具体算法选择（VASP 4.5+默认38）</span><br><span class="line">#     | 38: Blocked Davidson（精度高，适合绝缘体） |</span><br><span class="line">#     | 48: RMM-DIIS（速度快，适合金属/大体系） |</span><br><span class="line">IALGO = 48      # 强制使用RMM-DIIS（金属体系推荐）</span><br><span class="line"></span><br><span class="line">#   - LDIAG: 是否子空间对角化（默认.TRUE.）</span><br><span class="line">#     * .TRUE.: 更稳定但稍慢</span><br><span class="line">#     * .FALSE.: 可能加速但需谨慎（难收敛体系避免）</span><br><span class="line">LDIAG = .TRUE.  # 保持默认</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键参数组合建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 磁性体系（铁磁初始）：</span><br><span class="line">#   ISPIN=2, MAGMOM=4*2.0, ALGO=Fast</span><br><span class="line">#</span><br><span class="line"># 2. 金属体系快速计算：</span><br><span class="line">#   ALGO=Very_Fast 或 IALGO=48, LDIAG=.FALSE.</span><br><span class="line">#</span><br><span class="line"># 3. 难收敛绝缘体：</span><br><span class="line">#   ALGO=Normal, IALGO=38, LDIAG=.TRUE.</span><br><span class="line"># ================================================</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="输出文件控制参数">输出文件控制参数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># 1. 波函数与电荷密度输出</span><br><span class="line">#   - LWAVE: 是否输出波函数到 WAVECAR（默认 .TRUE.）</span><br><span class="line">#     | .TRUE.: 保存（续算必需）               |</span><br><span class="line">#     | .FALSE.: 不保存（节省磁盘空间）        |</span><br><span class="line">LWAVE = .TRUE.   # 推荐保留，否则续算需重新初始化</span><br><span class="line"></span><br><span class="line">#   - LCHARG: 是否输出电荷密度到 CHGCAR（默认 .TRUE.）</span><br><span class="line">#     | .TRUE.: 保存（能带/态密度计算必需）    |</span><br><span class="line">#     | .FALSE.: 不保存（快速测试时禁用）      |</span><br><span class="line">LCHARG = .TRUE.  # 推荐保留</span><br><span class="line"></span><br><span class="line"># 2. 势能与电子局域函数输出</span><br><span class="line">#   - LVTOT: 是否输出总局域势到 LOCPOT（默认 .FALSE.）</span><br><span class="line">#     * 用于功函数或静电势分析</span><br><span class="line">LVTOT = .FALSE.  # 按需开启（如表面计算）</span><br><span class="line"></span><br><span class="line">#   - LELF: 是否输出电子局域函数（ELF）到 ELFCAR（默认 .FALSE.）</span><br><span class="line">#     * 用于化学键/电子局域性分析（如判断金属/共价键）</span><br><span class="line">LELF = .FALSE.   # 按需开启（研究成键时设为 .TRUE.）</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键场景配置建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 常规自洽计算（SCF）：</span><br><span class="line">#   LWAVE=.TRUE., LCHARG=.TRUE.（保留续算文件）</span><br><span class="line">#</span><br><span class="line"># 2. 能带/态密度计算（非自洽）：</span><br><span class="line">#   LWAVE=.FALSE., LCHARG=.TRUE.（需读取CHGCAR）</span><br><span class="line">#</span><br><span class="line"># 3. 电子结构分析（成键/静电势）：</span><br><span class="line">#   LELF=.TRUE., LVTOT=.TRUE.（生成ELFCAR/LOCPOT）</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="绘制电荷密度">绘制电荷密度</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># 1. 部分电荷计算（投影电荷密度）</span><br><span class="line">#   - LPARD: 是否计算部分电荷（默认 .FALSE.）</span><br><span class="line">#     * 若开启，需同时设置 IBAND 或 KPUSE 指定范围</span><br><span class="line">LPARD = .TRUE.   # 开启部分电荷计算</span><br><span class="line"></span><br><span class="line">#   - IBAND: 指定计算的能带编号（从 1 开始）</span><br><span class="line">#     * 示例：计算第 176 和 177 条能带</span><br><span class="line">IBAND = 176 177  # 需结合体系实际能带数</span><br><span class="line"></span><br><span class="line">#   - KPUSE: 指定计算的 K 点编号（从 1 开始）</span><br><span class="line">#     * 示例：计算第 1 和第 7 个 K 点</span><br><span class="line">KPUSE = 1 7      # 需结合 KPOINTS 文件</span><br><span class="line"></span><br><span class="line"># 2. 输出控制</span><br><span class="line">#   - LSEPB: 是否按能带分开输出部分电荷（默认 .FALSE.）</span><br><span class="line">#     * 若 .TRUE., 生成 PARCHG.nb.*（每能带单独文件）</span><br><span class="line">LSEPB = .TRUE.   # 推荐开启，便于分析特定能带</span><br><span class="line"></span><br><span class="line">#   - LSEPK: 是否按 K 点分开输出部分电荷（默认 .FALSE.）</span><br><span class="line">#     * 若 .TRUE., 生成 PARCHG.nk.*（每 K 点单独文件）</span><br><span class="line">LSEPK = .TRUE.   # 推荐开启，便于分析 K 点依赖</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键操作步骤</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 先运行标准自洽计算（生成 CHGCAR 和 WAVECAR）</span><br><span class="line">#   LPARD=.FALSE., LWAVE=.TRUE., LCHARG=.TRUE.</span><br><span class="line">#</span><br><span class="line"># 2. 部分电荷计算（非自洽）：</span><br><span class="line">#   LPARD=.TRUE., ICHARG=11（读 CHGCAR）</span><br><span class="line">#   IBAND/KPUSE 按需设置，LSEPB/LSEPK=.TRUE.</span><br><span class="line">#</span><br><span class="line"># 3. 结果分析：</span><br><span class="line">#   - PARCHG.nb.*：能带分辨电荷密度（用 VESTA 可视化）</span><br><span class="line">#   - PARCHG.nk.*：K 点分辨电荷密度</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="更改配置">更改配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#FERWE = 159*1.0 1.0 0.0 80*0.0－－电子占据数从INCAR中读入并在计算中不变</span><br><span class="line">#FERDO = 159*1.0 0.0 1.0 80*0.0－－电子自旋极化计算 （按每个K点每个能带排列）</span><br><span class="line">#SIGMA=0.2    －－－－－－－－－－－展开宽度，默认ISMEAR=1 SIGMA=0.2</span><br><span class="line">#ISPIN=2    －－－－－－－－－－－－指定电子体系的总自旋。</span><br></pre></td></tr></table></figure><h3 id="并行计算">并行计算</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 1. 并行计算优化</span><br><span class="line">#   - LPLANE: 是否启用平面波系数并行（默认 .FALSE.）</span><br><span class="line">#     * .TRUE. 可加速大体系计算，但增加内存需求</span><br><span class="line">LPLANE = .TRUE.   # 推荐大体系开启</span><br><span class="line"></span><br><span class="line">#   - NPAR: 能带并行组数（默认=节点数）</span><br><span class="line">#     * NPAR=1: 每个节点计算一个能带（内存需求高）</span><br><span class="line">#     * NPAR=节点数/2: 平衡并行效率与内存</span><br><span class="line">NPAR = 1          # 小体系可用，大体系需调整</span><br><span class="line"></span><br><span class="line">#   - NSIM: 同时优化的能带数（默认 4）</span><br><span class="line">#     * 增大 NSIM 减少通信开销，但增加内存</span><br><span class="line">NSIM = 4          # 默认值通常最佳</span><br></pre></td></tr></table></figure><h3 id="外电场与偶极修正参数">外电场与偶极修正参数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 1. 外电场设置（单位：V/Å）</span><br><span class="line">#   - EFIELD: 沿 IDIPOL 方向施加的外电场强度</span><br><span class="line">#     * 示例：0.3 V/Å（典型值 0.1~1.0）</span><br><span class="line">EFIELD = 0.3      # 需与 IDIPOL 方向匹配</span><br><span class="line"></span><br><span class="line"># 2. 偶极修正控制</span><br><span class="line">#   - LDIPOL: 是否启用偶极修正（默认 .FALSE.）</span><br><span class="line">#     * 必须设为 .TRUE. 以消除 slab 计算的虚假偶极场</span><br><span class="line">LDIPOL = .TRUE.   # 表面/界面计算必需</span><br><span class="line"></span><br><span class="line">#   - IDIPOL: 偶极修正方向</span><br><span class="line">#     | 1-3: 沿晶矢 a/b/c 方向（slab 计算常用） |</span><br><span class="line">#     | 4:   全方向（孤立分子/团簇）          |</span><br><span class="line">IDIPOL = 1        # 示例：沿 a 轴（slab 法向）</span><br><span class="line"></span><br><span class="line">#   - DIPOL: 偶极修正中心坐标（分数坐标）</span><br><span class="line">#     * 默认 (0.5,0.5,0.5)（原胞中心）</span><br><span class="line">DIPOL = 0.5 0.5 0.5  # 保持默认除非特殊需求</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键场景配置建议</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 表面/界面计算（slab 模型）：</span><br><span class="line">#   EFIELD=0.0, LDIPOL=.TRUE., IDIPOL=3（沿 c 轴）</span><br><span class="line">#</span><br><span class="line"># 2. 外电场调控（如铁电体极化）：</span><br><span class="line">#   EFIELD=0.5, IDIPOL=3, DIPOL=0.5 0.5 0.5</span><br><span class="line">#</span><br><span class="line"># 3. 孤立分子（真空层充足时）：</span><br><span class="line">#   LDIPOL=.TRUE., IDIPOL=4</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure><h3 id="neb">NEB</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># 1. NEB 基本设置</span><br><span class="line">#   - ICHAIN: 选择方法（默认 0=标准NEB，2=CI-NEB）</span><br><span class="line">#     | 0: 标准NEB（不推荐，已过时）          |</span><br><span class="line">#     | 2: 攀爬图像法（CI-NEB，推荐）        |</span><br><span class="line">ICHAIN = 2       # 使用CI-NEB计算过渡态</span><br><span class="line"></span><br><span class="line">#   - IMAGES: 插值图像数（决定路径分辨率）</span><br><span class="line">#     * 需在POSCAR中提供初始和末态，并生成中间图像（如用nebmake.pl）</span><br><span class="line">IMAGES = 5       # 示例：5个中间图像（共7个点）</span><br><span class="line"></span><br><span class="line"># 2. 弹性常数与爬坡控制</span><br><span class="line">#   - SPRING: 图像间弹性常数（默认 -5.0）</span><br><span class="line">#     * 值越负，图像间距越刚性（推荐 -5 到 -10）</span><br><span class="line">SPRING = -5.0    # 默认值通常足够</span><br><span class="line"></span><br><span class="line">#   - LCLIMB: 是否启用爬坡（CI-NEB关键参数）</span><br><span class="line">#     | .TRUE.: 仅最高能图像爬坡（推荐）      |</span><br><span class="line">#     | .FALSE.: 禁用爬坡（普通NEB）         |</span><br><span class="line">LCLIMB = .TRUE.  # 启用爬坡定位过渡态</span><br><span class="line"></span><br><span class="line"># 3. 优化算法</span><br><span class="line">#   - IOPT: 优化算法选择</span><br><span class="line">#     | 1: 最速下降法（稳定但慢）           |</span><br><span class="line">#     | 2: FIRE算法（推荐）                 |</span><br><span class="line">#     | 3: 准牛顿法（LBFGS，高效但需梯度） |</span><br><span class="line">IOPT = 2         # 推荐FIRE算法</span><br><span class="line"></span><br><span class="line">#   - POTIM: 步长控制（依赖IOPT）</span><br><span class="line">#     * IOPT=2时，默认0.1（通常无需修改）</span><br><span class="line">POTIM = 0.1      # 默认值</span><br><span class="line"></span><br><span class="line"># ================================================</span><br><span class="line">#               关键操作步骤</span><br><span class="line"># ================================================</span><br><span class="line"># 1. 准备初始和末态POSCAR，生成中间图像：</span><br><span class="line">#    nebmake.pl POSCAR_initial POSCAR_final IMAGES</span><br><span class="line">#</span><br><span class="line"># 2. 检查路径连续性（可视化）：</span><br><span class="line">#    nebresults.pl</span><br><span class="line">#</span><br><span class="line"># 3. 收敛标准：</span><br><span class="line">#    - 力收敛（EDIFFG=-0.05）</span><br><span class="line">#    - 过渡态能量收敛（检查OSZICAR）</span><br><span class="line"># ================================================</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> DFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Multiwfn_noGUI安装教程</title>
      <link href="/posts/f20684d0/"/>
      <url>/posts/f20684d0/</url>
      
        <content type="html"><![CDATA[<h3 id="1-下载nogui版本"><strong>1.下载noGUI版本</strong></h3><p><a href="http://sobereva.com/multiwfn/misc/Multiwfn_3.8_dev_bin_Linux_noGUI.zip">下载地址</a><br>unzip 解压在home/username目录下<br><code>vim ~/.bashrc</code> 粘贴下面内容至末尾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ulimit</span> -s unlimited</span><br><span class="line"><span class="built_in">export</span> OMP_STACKSIZE=200M</span><br><span class="line"><span class="built_in">export</span> Multiwfnpath=/home/username/Multiwfn_[版本号]_bin_Linux_noGUI</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/username/Multiwfn_[版本号]_bin_Linux_noGUI</span><br></pre></td></tr></table></figure><h3 id="2-增加可执行权限"><strong>2.增加可执行权限</strong></h3><p>Multiwfn的普通版的可执行文件是Multiwfn目录下的Multiwfn，noGUI版是Multiwfn目录下的Multiwfn_noGUI。<br>加上可执行权限<br>对于普通版，在终端里运行<code>chmod + x /home/username/Multiwfn_[版本号]_bin_Linux/Multiwfn</code>。<br>如果是noGUI版，显然把其中的Multiwfn替换成Multiwfn_noGUI。</p><h3 id="3-配置settings-ini"><strong>3.配置settings.ini</strong></h3><p>编辑Multiwfn目录下的settings.ini</p><ul><li><strong>nthreads</strong>，将之数值改为计算时要用的并行核数，通常设为CPU的物理核心数即可。</li><li><strong>formchkpath</strong>：定义的是Gaussian目录下的formchk程序的路径。</li><li><strong>gaupath</strong>：设成Gaussian可执行文件的路径，Multiwfn的一些功能才能自动调用Gaussian进行计算.</li><li><strong>其他</strong>：RESP2.sh等脚本文件要将Multiwfn改为Mltiwfn_noGUI</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DFT </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>标签</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>链接</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>分类</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>关于</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
